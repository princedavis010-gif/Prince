<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Prince Tap: Elite</title>
    <script src="https://adsgram.ai/sdk/v1/adman.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #f3ba2f; --dark-gold: #8e6d1a; --shine: rgba(255,255,255,0.4); --dark: #0b0e11; --green: #00ff88; --dia: #00d2ff; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Inter', sans-serif; color: white; background: radial-gradient(circle at center, #1c1f24 0%, #0b0e11 100%); user-select: none; -webkit-tap-highlight-color: transparent; touch-action: none; }
        
        #balance { font-size: 55px; font-weight: 900; color: var(--gold); text-shadow: 0 0 30px rgba(243, 186, 47, 0.4); margin-top: 10px; }

        /* --- THE STYLISH 3D COIN --- */
        .coin-wrap { position: relative; margin: 25px 0; display: flex; justify-content: center; align-items: center; width: 100%; perspective: 1000px; }
        
        .coin-btn { 
            width: 280px; height: 280px; 
            /* Multi-layer gradient for metallic texture */
            background: 
                linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 100%),
                radial-gradient(circle at 30% 30%, #ffe08a 0%, #f3ba2f 40%, #bf9524 70%, #8e6d1a 100%);
            border-radius: 50%; 
            /* Diamond-cut outer rim */
            border: 4px solid #5c4711;
            outline: 8px solid var(--gold);
            outline-offset: -12px;
            
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.8), 
                inset 0 2px 5px var(--shine),
                inset 0 -5px 15px rgba(0,0,0,0.4);
            
            display: flex; align-items: center; justify-content: center; 
            font-size: 130px; color: #5c4711; font-weight: 900; 
            text-shadow: 1px 1px 0px rgba(255,255,255,0.2), -1px -1px 0px rgba(0,0,0,0.5);
            cursor: pointer; transition: transform 0.1s, box-shadow 0.3s; 
            transform-origin: center center;
        }

        /* Glowing Pulse when Energy is high */
        .coin-btn.glow { animation: goldPulse 2s infinite; }
        @keyframes goldPulse {
            0% { box-shadow: 0 20px 40px rgba(0,0,0,0.8), 0 0 0px rgba(243, 186, 47, 0); }
            50% { box-shadow: 0 20px 40px rgba(0,0,0,0.8), 0 0 30px rgba(243, 186, 47, 0.4); }
            100% { box-shadow: 0 20px 40px rgba(0,0,0,0.8), 0 0 0px rgba(243, 186, 47, 0); }
        }

        .tap-anim { position: absolute; color: white; font-size: 38px; font-weight: 900; pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 1000; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-150px) scale(1.2); } }

        /* UI ELEMENTS */
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; }
        .container.active { display: flex; }
        .btn-gold { background: linear-gradient(to bottom, #f3ba2f, #bf9524); color: #403108; padding: 15px; border-radius: 14px; font-weight: 800; border: none; width: 90%; text-transform: uppercase; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 0 #8e6d1a; }
        .btn-gold:active { transform: translateY(2px); box-shadow: 0 2px 0 #8e6d1a; }
        .nav { height: 75px; background: rgba(22, 24, 28, 0.95); backdrop-filter: blur(10px); display: flex; justify-content: space-around; align-items: center; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #333; z-index: 3000; }
        .nav-item { color: #666; font-size: 11px; text-align: center; flex: 1; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body>

    <div id="home" class="container active">
        <div id="user-display" style="color:var(--green); font-size:14px; letter-spacing:1px;"></div>
        <div id="balance">0</div>
        <div style="color: var(--dia); font-weight: bold;">ðŸ’Ž <span id="diamonds">0</span></div>
        <div style="color: #888; margin: 5px 0;">âš¡ <span id="energy">1000</span> / 1000</div>
        
        <div class="coin-wrap">
            <div class="coin-btn glow" id="coin">P</div>
        </div>
        
        <button class="btn-gold" style="background: #ff4444; color:white; display:none;" id="refill-btn" onclick="runAd('refill')">âš¡ Instant Refill</button>
        <button class="btn-gold" style="background: var(--dia); color: #004a5c;" onclick="runAd('coins')">ðŸ“º Claim +1,000 Coins</button>
        <button class="btn-gold" onclick="inviteFriend()" style="background: #5865F2; color:white;">âž• Invite Partners</button>
    </div>

    <div id="pay" class="container">
        <h2 style="color: var(--gold);">Upgrade Center</h2>
        <div id="sub-active-view" style="width: 100%; text-align: center;">
            <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 20px; border: 1px solid var(--gold); width: 85%; margin: 0 auto;">
                <p>Get **Premium** for 10x Multiplier</p>
                <p style="color: var(--gold); font-size: 20px; font-weight: bold;">OPay: 8124647818</p>
                <button class="btn-gold" onclick="sendWA()">Request Code</button>
            </div>
            <input type="text" id="secret-code" class="btn-gold" style="background:#000; color:#fff; border:1px solid #333;" placeholder="Verification Code">
            <input type="text" id="username-input" class="btn-gold" style="background:#000; color:#fff; border:1px solid #333;" placeholder="Choose Username">
            <button class="btn-gold" style="background: var(--green);" onclick="strictSubscribe()">Activate Now</button>
        </div>
        <div id="sub-locked-view" style="display:none; color:var(--green);"><h3>âœ… ELITE MEMBER</h3></div>
    </div>

    <div id="profile" class="container">
        <h2 style="color: var(--gold);">Executive Profile</h2>
        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px; width: 90%; text-align: center; border: 1px solid #333;">
            <p id="p-username" style="font-size: 24px; color: var(--green); font-weight: bold;">GUEST</p>
            <p style="color:#666;">Total Earnings: <span id="p-lifetime" style="color:var(--gold);">0</span></p>
        </div>
        <button class="btn-gold" style="background: var(--dia);" onclick="redeem()">Redeem Airtime</button>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ðŸª™<br>Tap</div>
        <div class="nav-item" onclick="showTab('pay', this)">âš¡<br>Boost</div>
        <div class="nav-item" onclick="showTab('profile', this)">ðŸ‘¤<br>Admin</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        const userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "00";
        const suffix = parseInt(String(userId).slice(-2));
        const REQUIRED_CODE = "Prince2026" + (suffix * 3 + 7);

        let bal = parseInt(localStorage.getItem('bal_'+userId)) || 0;
        let lifetime = parseInt(localStorage.getItem('life_'+userId)) || 0;
        let diamonds = parseInt(localStorage.getItem('dia_'+userId)) || 0;
        let eng = parseInt(localStorage.getItem('eng_'+userId)) || 1000;
        let isPremium = localStorage.getItem('premium_'+userId) === 'true';
        let userNick = localStorage.getItem('nick_'+userId) || "GUEST";

        function updateUI() {
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = diamonds;
            document.getElementById('energy').innerText = eng;
            document.getElementById('refill-btn').style.display = eng < 100 ? "block" : "none";
            document.getElementById('p-lifetime').innerText = lifetime.toLocaleString();
            document.getElementById('p-username').innerText = userNick.toUpperCase();
            
            // Add/Remove glow based on energy
            if(eng > 800) document.getElementById('coin').classList.add('glow');
            else document.getElementById('coin').classList.remove('glow');

            if (isPremium) {
                document.getElementById('user-display').innerText = "â­ " + userNick.toUpperCase();
                document.getElementById('sub-active-view').style.display = "none";
                document.getElementById('sub-locked-view').style.display = "block";
            }
            localStorage.setItem('bal_'+userId, bal);
            localStorage.setItem('life_'+userId, lifetime);
            localStorage.setItem('dia_'+userId, diamonds);
            localStorage.setItem('eng_'+userId, eng);
        }

        function runAd(type) {
            if (!window.Adsgram) return;
            window.Adsgram.init({ blockId: "22672" }).show().then(() => {
                if (type === 'refill') eng = 1000; else { bal += 1000; lifetime += 1000; }
                updateUI();
            });
        }

        function strictSubscribe() {
            if (document.getElementById('secret-code').value.trim() === REQUIRED_CODE) {
                userNick = document.getElementById('username-input').value.trim() || "ELITE";
                isPremium = true;
                localStorage.setItem('premium_'+userId, 'true');
                localStorage.setItem('nick_'+userId, userNick);
                updateUI();
                tg.showAlert("PREMIUM UNLOCKED");
            } else { tg.showAlert("WRONG CODE"); }
        }

        const coin = document.getElementById('coin');
        coin.addEventListener('pointerdown', (e) => {
            if (eng > 0) {
                const tapVal = isPremium ? 10 : 1;
                bal += tapVal; lifetime += tapVal; eng--;
                const float = document.createElement('div');
                float.className = 'tap-anim';
                float.innerText = '+' + tapVal;
                float.style.left = (e.clientX - 20) + 'px';
                float.style.top = (e.clientY - 40) + 'px';
                document.body.appendChild(float);
                setTimeout(() => float.remove(), 800);
                const rect = coin.getBoundingClientRect();
                const x = (e.clientX - rect.left - rect.width/2)/8;
                const y = (e.clientY - rect.top - rect.height/2)/8;
                coin.style.transform = `perspective(1000px) rotateX(${-y}deg) rotateY(${x}deg) scale(0.92)`;
                updateUI();
            }
        });
        coin.addEventListener('pointerup', () => coin.style.transform = "perspective(1000px) scale(1)");

        function showTab(id, el) {
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active'); el.classList.add('active');
        }

        function inviteFriend() { window.open(`https://t.me/share/url?url=https://t.me/PrinceTap_bot/play?startapp=${userId}&text=Join the Elite!`); }
        function sendWA() { window.open(`https://wa.me/2348124647818?text=Premium Suffix: ${suffix}`); }
        function redeem() {
            if (bal >= 20000) { bal -= 20000; diamonds++; updateUI(); window.open(`https://wa.me/2348124647818?text=Redeem Diamond: ${suffix}`); }
            else { tg.showAlert("Need 20,000 Coins"); }
        }

        setInterval(() => { if (isPremium) { bal += 10; lifetime += 10; updateUI(); } }, 1000);
        setInterval(() => { if (eng < 1000) { eng++; updateUI(); } }, 2000);
        updateUI();
    </script>
</body>
</html>
