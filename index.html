<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto_Tap v64.0</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --purple: #a020f0; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); transition: 0.8s; }
        .coin-wrapper { perspective: 1000px; margin: 35px 0; z-index: 5; }
        .coin-btn { 
            width: 300px; height: 300px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            transition: transform 0.08s ease-out; transform-style: preserve-3d; cursor: pointer;
            background-image: url('https://raw.githubusercontent.com/princedavis010-gif/Prince/refs/heads/main/IMG-20260212-WA0024.jpg');
            background-size: cover; background-position: center; border: none; box-shadow: 0 25px 50px rgba(0,0,0,0.8);
        }
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; width: 100%; }
        .container.active { display: flex; animation: fadeIn 0.4s ease; }
        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #221a04; padding: 16px; border-radius: 15px; font-weight: 800; border: none; width: 100%; margin-top: 10px; cursor: pointer; text-transform: uppercase; }
        .btn-active-grey { background: #555 !important; color: #888 !important; cursor: pointer !important; }
        .glass-card { background: rgba(255,255,255,0.06); border-radius: 18px; padding: 15px; width: 100%; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
        .nav { height: 85px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; z-index: 1000; }
        .nav-item { flex: 1; text-align: center; padding-top: 20px; color: #666; font-size: 10px; font-weight: bold; }
        .nav-item.active { color: var(--gold); }
        .mystery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; width: 100%; }
        .box { background: #222; border: 2px solid var(--gold); height: 80px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; cursor: pointer; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body onload="initApp();">
    <div id="home" class="container active">
        <div id="balance" style="font-size: 50px; font-weight: 900; color: var(--gold);">0</div>
        <div style="font-size: 18px; color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span></div>
        <div id="prem-timer" style="color:var(--green); font-weight:bold; font-size:12px;"></div>
        <div class="coin-wrapper"><div class="coin-btn" id="coin" onpointerdown="handleTap(event)"></div></div>
        <div style="color:#777; font-size:12px;">‚ö° <span id="energy">1000</span> / <span id="max-energy">1000</span></div>
        <button class="btn-gold" style="background:var(--green); margin-top:20px;" onclick="claimDaily()">üìÖ DAILY CHECK-IN</button>
    </div>

    <div id="shop" class="container">
        <h2 style="color:var(--gold);">BOOSTERS</h2>
        <div class="glass-card"><h3>ü§ñ AUTO-TAP BOT</h3><button id="bot-purchase-btn" class="btn-gold" onclick="buyBot()">PURCHASE FOR 15,000</button></div>
        <div class="glass-card"><h3>üî® UPGRADES</h3>
            <button class="btn-gold" onclick="upgradeTap()">UPGRADE TAP POWER (Cost: <span id="tap-cost">10000</span>)</button>
            <button class="btn-gold" style="background:var(--dia);" onclick="upgradeEnergy()">EXPAND ENERGY (Cost: <span id="eng-cost">2000</span>)</button>
        </div>
        <div class="glass-card"><h3>üéÅ MYSTERY SQUARE</h3><p>Cost: 5,000 | Win big prizes!</p>
            <div class="mystery-grid" id="mystery-grid">
                <div class="box" onclick="openBox(0)">?</div><div class="box" onclick="openBox(1)">?</div><div class="box" onclick="openBox(2)">?</div>
                <div class="box" onclick="openBox(3)">?</div><div class="box" onclick="openBox(4)">?</div><div class="box" onclick="openBox(5)">?</div>
                <div class="box" onclick="openBox(6)">?</div><div class="box" onclick="openBox(7)">?</div><div class="box" onclick="openBox(8)">?</div>
            </div>
        </div>
    </div>

    <div id="premium" class="container">
        <h2 style="color:var(--gold);">ELITE SHOP</h2>
        <div class="glass-card">
            <p style="color:var(--gold); font-weight:bold; font-size:24px;">ID: <span id="p-suffix">--</span></p>
            <p>Premium (20x Tap) | ‚Ç¶200</p>
            <p>OPay: <b>8124647818</b></p>
            <label for="receipt-upload" class="btn-gold" style="display:block; text-align:center;">üìÅ UPLOAD RECEIPT</label>
            <input type="file" id="receipt-upload" accept="image/*" style="display:none;" onchange="uploadReceipt()">
            <p id="upload-status" style="font-size:12px; color:var(--green);"></p>
        </div>
        <div class="glass-card"><input type="text" id="code-input" class="btn-gold" style="background:#111; color:#fff; text-align:center;" placeholder="ENTER CODE"><button id="activate-btn" class="btn-gold" style="background:var(--green);" onclick="activatePremium()">ACTIVATE PREMIUM</button></div>
        <div class="glass-card" onclick="handleAdminTap()">üìú RECENT ACTIVITY<div id="tx-history" style="font-size:10px; margin-top:5px;"></div></div>
        <div id="admin-box" style="display:none;" class="glass-card">
            <input type="text" id="adm-suffix" placeholder="Suffix" style="width:45%;"><input type="number" id="adm-salt" placeholder="Salt" style="width:45%;">
            <button class="btn-gold" onclick="generateAdminCode()">GENERATE</button><p id="gen-result"></p>
        </div>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Home</div>
        <div class="nav-item" onclick="showTab('shop', this)">‚ö°<br>Boost</div>
        <div class="nav-item" onclick="showTab('premium', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp; const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "0000";
        const suffix = uid.slice(-4); const v = "v64_"; const botToken = "8494916372:AAHnNbLt8lykAKqUuGLIZnY0BBoC6UB0qbI";
        const chatId = "-1003843441800"; const secretKey = 777; const clickSnd = new Audio('https://www.soundjay.com/buttons/sounds/button-50.mp3');

        let bal = parseInt(localStorage.getItem(v+'bal')) || 0; let dia = parseInt(localStorage.getItem(v+'dia')) || 0;
        let hasBot = localStorage.getItem(v+'hasBot') === 'true'; let botExpiry = parseInt(localStorage.getItem(v+'botExp')) || 0;
        let premExpiry = parseInt(localStorage.getItem(v+'premExp')) || 0; let maxEng = parseInt(localStorage.getItem(v+'maxEng')) || 1000;
        let eng = maxEng; let tapLvl = parseInt(localStorage.getItem(v+'tapLvl')) || 1; let streak = parseInt(localStorage.getItem(v+'streak')) || 0;
        let lastCheck = localStorage.getItem(v+'lastCheck'); let salt = 1; let vibDone = false;

        function initApp() { updateUI(); if(hasBot) startBotLoop(); setInterval(tick, 1000); }

        function handleTap(e) {
            if(eng <= 0) return;
            clickSnd.currentTime = 0; clickSnd.play();
            let multi = (premExpiry > Date.now() ? 20 : 1);
            let val = tapLvl * multi; bal += val; eng--;
            if(bal >= 20000 && !vibDone) { navigator.vibrate([200, 100, 200]); vibDone = true; }
            updateUI();
        }

        function buyBot() {
            if(!hasBot && bal >= 15000) {
                bal -= 15000; hasBot = true; localStorage.setItem(v+'hasBot', true);
                tg.showAlert("Auto Tap Bot successfully purchased. Good job!");
                activateBot();
            } else if(hasBot && botExpiry <= Date.now()) {
                activateBot();
            } else if(hasBot) {
                let rem = botExpiry - Date.now();
                let h = Math.floor(rem/(1000*60*60)); let m = Math.floor((rem%(1000*60*60))/(1000*60));
                tg.showAlert(`ü§ñ Auto Farm Bot is ACTIVE, ${h}h ${m}m remaining`);
            }
            updateUI();
        }

        function activateBot() {
            botExpiry = Date.now() + (12*60*60*1000);
            localStorage.setItem(v+'botExp', botExpiry);
            tg.showAlert("You have successfully reactivate your auto farming bot. Good job! üéâ");
            setTimeout(() => {
                fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST', headers: {'Content-Type':'application/json'},
                    body: JSON.stringify({chat_id: uid, text: "üóØü´Ü‚ö°Ô∏è Your auto tap bot has tapped coins for you. Come back to claim the coins and re-activate your bot."})
                });
            }, 12*60*60*1000);
            updateUI();
        }

        function openBox(idx) {
            if(bal < 5000) { tg.showAlert("Need 5,000 coins!"); return; }
            bal -= 5000;
            // RIGGED LOGIC: Diamonds are at index 0 and 8. Win is restricted to 1-7.
            let winIdx = Math.floor(Math.random() * 6) + 1; 
            const boxes = document.querySelectorAll('.box');
            boxes.forEach((b, i) => {
                if(i === 0) b.innerText = "1üíé";
                else if(i === 8) b.innerText = "2üíé";
                else b.innerText = "500ü™ô";
                if(i === winIdx) { b.style.background = "var(--green)"; bal += 500; }
            });
            tg.showAlert("You won 500 Coins!");
            setTimeout(() => { boxes.forEach(b => {b.innerText="?"; b.style.background="#222";}); updateUI(); }, 2000);
        }

        function claimDaily() {
            const today = new Date().toISOString().split('T')[0];
            if(lastCheck === today) { tg.showAlert("Come back tomorrow! üí§"); return; }
            streak = (lastCheck === new Date(Date.now()-86400000).toISOString().split('T')[0]) ? streak + 1 : 1;
            if(streak > 7) streak = 1;
            const rewards = [0, 1000, 2000, 3000, 5000, 7500, 10000, 20000];
            const msgs = ["", "Day 1: +1,000! Good start! ü™ô", "Day 2: +2,000! Keep it up! ‚ö°", "Day 3: +3,000! Roll! üî•", "Day 4: +5,000! Dedicated! üî®", "Day 5: +7,500! Almost there! üöÄ", "Day 6: +10,000! ELITE! ‚≠ê", "Day 7: +20,000! MASTER! üèÜ"];
            bal += rewards[streak]; lastCheck = today;
            localStorage.setItem(v+'streak', streak); localStorage.setItem(v+'lastCheck', lastCheck);
            tg.showAlert(msgs[streak]); updateUI();
        }

        function upgradeTap() { 
            let cost = tapLvl * 10000; 
            if(bal >= cost) { bal -= cost; tapLvl++; localStorage.setItem(v+'tapLvl', tapLvl); updateUI(); tg.showAlert("üî® Tap Power Increased!"); }
        }

        function upgradeEnergy() { 
            let cost = maxEng * 2; 
            if(bal >= cost) { bal -= cost; maxEng += 500; localStorage.setItem(v+'maxEng', maxEng); updateUI(); tg.showAlert("‚ö° Energy Tank Expanded!"); }
        }

        function updateUI() {
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('energy').innerText = eng;
            document.getElementById('max-energy').innerText = maxEng;
            document.getElementById('p-suffix').innerText = suffix;
            document.getElementById('tap-cost').innerText = (tapLvl * 10000).toLocaleString();
            document.getElementById('eng-cost').innerText = (maxEng * 2).toLocaleString();
            
            const bBtn = document.getElementById('bot-purchase-btn');
            if(!hasBot) { bBtn.innerText = "PURCHASE FOR 15,000"; bBtn.className = "btn-gold"; }
            else if(botExpiry > Date.now()) { bBtn.innerText = "WORKING..."; bBtn.className = "btn-gold btn-active-grey"; }
            else { bBtn.innerText = "ACTIVATE"; bBtn.className = "btn-gold"; bBtn.style.background = "var(--green)"; }

            if(bal >= 50000) { bal -= 50000; dia++; confetti(); }
            localStorage.setItem(v+'bal', bal); localStorage.setItem(v+'dia', dia);
        }

        function tick() {
            if(eng < maxEng) eng++;
            const t = document.getElementById('prem-timer');
            if(premExpiry > Date.now()) {
                let d = Math.floor((premExpiry-Date.now())/(1000*60*60*24));
                let h = Math.floor(((premExpiry-Date.now())%(1000*60*60*24))/(1000*60*60));
                t.innerText = `PREMIUM: ${d}d ${h}h left`;
            } else { t.innerText = ""; }
            updateUI();
        }

        function showTab(id, el) { 
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active'); el.classList.add('active');
        }

        // --- ADMIN & PREMIUM LOGIC ---
        function activatePremium() {
            const input = document.getElementById('code-input').value.trim();
            const p1 = (parseInt(suffix) + secretKey).toString(16);
            const p2 = (parseInt(salt) * 157).toString(16);
            if(input === `DVS-${p1}-${p2}-${suffix}`) {
                premExpiry = Date.now() + (3*24*60*60*1000); salt++;
                localStorage.setItem(v+'premExp', premExpiry);
                tg.showAlert("Congratulations! You have successfully subscribed to Premium. You are now a Premium User!");
            }
        }

        async function uploadReceipt() {
            const f = document.getElementById('receipt-upload').files[0];
            const fd = new FormData(); fd.append('chat_id', chatId); fd.append('photo', f);
            fd.append('caption', `üßæ RECEIPT\nSuffix: ${suffix}\nUID: ${uid}`);
            const r = await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {method:'POST', body:fd});
            if(r.ok) tg.showAlert("Sent! Verification pending.");
        }

        let aTaps = 0; function handleAdminTap() { aTaps++; if(aTaps===3){ if(prompt("Pass:")==="DavisAdmin2026") document.getElementById('admin-box').style.display='block'; aTaps=0; } }
        function generateAdminCode() {
            const s = document.getElementById('adm-suffix').value; const sl = document.getElementById('adm-salt').value;
            const c = `DVS-${(parseInt(s)+777).toString(16)}-${(parseInt(sl)*157).toString(16)}-${s}`;
            document.getElementById('gen-result').innerText = c;
        }
    </script>
</body>
</html>
