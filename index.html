<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tap: Master Local</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --purple: #a020f0; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); transition: 0.8s; }

        /* SUPERNOVA WARP BACKGROUND */
        .nebula-bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -2; background: #010205; overflow: hidden; }
        .nebula-glow { position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; background: radial-gradient(circle, rgba(160,32,240,0.4) 0%, rgba(0,210,255,0.1) 40%, transparent 70%); opacity: 0; transition: 1.5s; z-index: -1; pointer-events: none; }
        body.boost-active .nebula-glow { opacity: 1; animation: supernovaWarp 3s infinite linear; }
        @keyframes supernovaWarp { 0% { transform: scale(1) rotate(0deg); filter: hue-rotate(0deg); } 50% { transform: scale(1.3) rotate(180deg); filter: hue-rotate(90deg); } 100% { transform: scale(1) rotate(360deg); filter: hue-rotate(0deg); } }

        /* ADMIN PANEL */
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #05070a; z-index: 9999; padding: 25px; overflow-y: auto; }
        .admin-search { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid var(--gold); background: #111; color: white; margin-bottom: 20px; font-size: 16px; }
        .user-card { background: rgba(255,255,255,0.08); padding: 20px; border-radius: 15px; border-left: 5px solid var(--gold); }

        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; width: 100%; }
        .container.active { display: flex; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .coin-btn { width: 280px; height: 280px; background: radial-gradient(circle, #ffe08a, #f3ba2f, #8e6d1a); border-radius: 50%; border: 10px solid #3d2f07; box-shadow: 0 15px 40px rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; font-size: 140px; color: #3d2f07; font-weight: 900; transition: 0.1s; transform-style: preserve-3d; cursor: pointer; }
        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #221a04; padding: 16px; border-radius: 15px; font-weight: 800; border: none; width: 100%; margin-top: 10px; cursor: pointer; text-transform: uppercase; }
        .nav { height: 85px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; }
        .nav-item { flex: 1; text-align: center; padding-top: 20px; color: #666; font-size: 11px; font-weight: bold; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body onload="initApp();">
    <div id="admin-panel">
        <h2 style="color:var(--gold);">LOCAL DATA SEARCH</h2>
        <input type="text" id="admin-search-input" class="admin-search" placeholder="Enter Telegram ID..." onkeyup="searchLocal()">
        <div id="search-result">
            <p style="color:#666; text-align:center;">Enter ID to verify user session</p>
        </div>
        <button class="btn-gold" style="margin-top:30px;" onclick="closeAdmin()">EXIT ADMIN</button>
    </div>

    <div class="nebula-bg"><div class="nebula-glow"></div></div>

    <div id="home" class="container active">
        <div id="balance" onclick="adminTrigger()" style="font-size: 60px; font-weight: 900; color: var(--gold); cursor:pointer;">0</div>
        <div style="font-size: 20px; color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span></div>
        <div style="margin: 5px 0; color: #ccc;">‚ö° <span id="energy">1000</span> / 1000</div>
        <div class="coin-wrapper">
            <div class="coin-btn" id="coin">P</div>
        </div>
        <div id="boost-timer" style="color:var(--purple); font-weight:bold; height:20px;"></div>
        <button class="btn-gold" style="background: var(--dia); color:#000;" onclick="showAd()">üì∫ WATCH AD (+2,000)</button>
    </div>

    <div id="shop" class="container">
        <h2 style="color:var(--gold);">DAILY BOOSTS</h2>
        <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:15px; width:100%;">
            <p>Supernova Warp (5x): <span id="boost-count">2</span>/2</p>
            <button class="btn-gold" style="background:var(--purple); color:white;" onclick="activateBoost()">ACTIVATE WARP</button>
            <p style="margin-top:20px;">Multi-Tap Lvl: <span id="lvl-tap">1</span></p>
            <button class="btn-gold" onclick="buyUpgrade()">UPGRADE (1,000 Coins)</button>
        </div>
    </div>

    <div id="premium" class="container">
        <h2 style="color:var(--gold);">PREMIUM INFO</h2>
        <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:15px; width:100%;">
            <p>1 Diamond = ‚Ç¶100 Airtime</p>
            <p>Premium Subscription = ‚Ç¶200</p>
            <p>OPay: <b>8124647818</b></p>
            <input type="text" id="uname-input" class="btn-gold" style="background:#111; color:#fff; text-align:center;" placeholder="USERNAME">
            <input type="text" id="code-input" class="btn-gold" style="background:#111; color:#fff; text-align:center;" placeholder="ACTIVATION CODE">
            <button class="btn-gold" style="background:var(--green);" onclick="activatePremium()">ACTIVATE</button>
        </div>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Tap</div>
        <div class="nav-item" onclick="showTab('shop', this)">‚ö°<br>Shop</div>
        <div class="nav-item" onclick="showTab('premium', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "GUEST";
        
        let bal = parseInt(localStorage.getItem('bal_'+uid)) || 0;
        let dia = parseInt(localStorage.getItem('dia_'+uid)) || 0;
        let ads = parseInt(localStorage.getItem('ads_'+uid)) || 0;
        let boosts = parseInt(localStorage.getItem('boosts_'+uid));
        let tapLvl = parseInt(localStorage.getItem('tapLvl_'+uid)) || 1;
        let isPrem = localStorage.getItem('prem_'+uid) === 'true';
        let eng = 1000, isBoosted = false, adminTaps = 0;

        const AdController = window.Adsgram.init({ blockId: "22672" });

        function initApp() {
            checkDailyReset();
            updateUI();
        }

        function checkDailyReset() {
            const now = new Date();
            const watTime = new Date(now.getTime() + (1 * 60 * 60 * 1000));
            const resetKey = 'lastReset_' + uid;
            const last = localStorage.getItem(resetKey);
            if (!last || new Date(last).getDate() !== watTime.getDate()) {
                boosts = 2;
                localStorage.setItem(resetKey, watTime.toISOString());
            }
            if (isNaN(boosts)) boosts = 2;
        }

        function updateUI() {
            if (bal >= 20000) { bal -= 20000; dia++; confetti(); }
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('boost-count').innerText = boosts;
            document.getElementById('lvl-tap').innerText = tapLvl;
            
            localStorage.setItem('bal_'+uid, bal);
            localStorage.setItem('dia_'+uid, dia);
            localStorage.setItem('ads_'+uid, ads);
            localStorage.setItem('boosts_'+uid, boosts);
            localStorage.setItem('tapLvl_'+uid, tapLvl);
        }

        function searchLocal() {
            const query = document.getElementById('admin-search-input').value;
            const res = document.getElementById('search-result');
            if (query === uid) {
                res.innerHTML = `<div class="user-card"><p><b>ID:</b> ${uid}</p><p;><b>Coins:</b> ${bal.toLocaleString()}</p><p><b>Ads:</b> ${ads}</p></div>`;
            } else {
                res.innerHTML = `<p style="color:#555; text-align:center;">Only current session ID found.</p>`;
            }
        }

        document.getElementById('coin').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (eng > 0) {
                let v = isPrem ? 20 : tapLvl;
                if (isBoosted) v *= 5;
                bal += v; eng--; updateUI();
                const rect = e.target.getBoundingClientRect();
                const x = ((e.touches[0].clientX - rect.left) / rect.width - 0.5) * 40;
                const y = ((e.touches[0].clientY - rect.top) / rect.height - 0.5) * -40;
                e.target.style.transform = `rotateY(${x}deg) rotateX(${y}deg) scale(0.95)`;
                setTimeout(() => { e.target.style.transform = "rotate(0) scale(1)"; }, 100);
            }
        });

        function activateBoost() {
            if (boosts > 0 && !isBoosted) {
                boosts--; isBoosted = true;
                document.body.classList.add('boost-active');
                let sec = 30;
                const t = setInterval(() => {
                    sec--;
                    document.getElementById('boost-timer').innerText = `WARP: ${sec}s`;
                    if (sec <= 0) { clearInterval(t); isBoosted = false; document.body.classList.remove('boost-active'); document.getElementById('boost-timer').innerText = ""; updateUI(); }
                }, 1000);
                updateUI();
            }
        }

        function showAd() { AdController.show().then(() => { ads++; bal += 2000; updateUI(); }).catch(() => tg.showAlert("Ad busy.")); }
        function buyUpgrade() { if (bal >= 1000) { bal -= 1000; tapLvl++; updateUI(); } }
        function activatePremium() { if (document.getElementById('code-input').value === "Davis2026") { isPrem = true; localStorage.setItem('prem_'+uid, 'true'); updateUI(); tg.showAlert("Premium Active!"); } }
        function adminTrigger() { adminTaps++; if (adminTaps >= 5) { if(prompt("Pass:")==="Davis2026") document.getElementById('admin-panel').style.display='block'; adminTaps=0; } }
        function closeAdmin() { document.getElementById('admin-panel').style.display='none'; }
        function showTab(id, el) { document.querySelectorAll('.container').forEach(c => c.classList.remove('active')); document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); document.getElementById(id).classList.add('active'); el.classList.add('active'); }
        setInterval(() => { if (eng < 1000) { eng++; updateUI(); } }, 1000);
    </script>
</body>
</html>
