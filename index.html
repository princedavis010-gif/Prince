<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tap: Elite</title>
    <script src="https://adsgram.ai/sdk/v1/adman.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --red: #ff4444; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Inter', sans-serif; color: white; background: #0b0e11; user-select: none; -webkit-tap-highlight-color: transparent; touch-action: none; }
        .bg-animate { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; background: radial-gradient(circle at 50% 50%, #1c1f24 0%, #0b0e11 100%); }
        .blob { position: absolute; width: 350px; height: 350px; background: linear-gradient(135deg, rgba(243, 186, 47, 0.1), rgba(0, 210, 255, 0.1)); filter: blur(90px); border-radius: 50%; animation: move 20s infinite alternate; }
        @keyframes move { from { transform: translate(-20%, -20%); } to { transform: translate(20%, 20%); } }
        #reward-feed { position: absolute; top: -60px; left: 50%; transform: translateX(-50%); width: 85%; background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px); padding: 10px; border-radius: 12px; font-size: 11px; font-weight: bold; color: var(--dia); transition: top 0.5s; z-index: 4000; text-align: center; }
        #reward-feed.show { top: 15px; }
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; }
        .container.active { display: flex; }
        .btn-gold { background: linear-gradient(to bottom, #f3ba2f, #bf9524); color: #403108; padding: 15px; border-radius: 14px; font-weight: 800; border: none; width: 95%; text-transform: uppercase; cursor: pointer; margin-top: 10px; box-shadow: 0 5px 0 #8e6d1a; transition: transform 0.05s; }
        .btn-gold:active { transform: translateY(4px); box-shadow: 0 1px 0 #8e6d1a; }
        .glass-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); width: 90%; padding: 15px; border-radius: 18px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 12px; }
        .coin-btn { width: 280px; height: 280px; background: radial-gradient(circle at 30% 30%, #ffe08a 0%, #f3ba2f 40%, #bf9524 100%); border-radius: 50%; border: 4px solid #5c4711; outline: 8px solid var(--gold); outline-offset: -12px; box-shadow: 0 20px 40px rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; font-size: 130px; color: #5c4711; font-weight: 900; transition: transform 0.1s; }
        .nav { height: 75px; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); display: flex; justify-content: space-around; align-items: center; position: fixed; bottom: 0; width: 100%; border-top: 1px solid rgba(255, 255, 255, 0.1); z-index: 3000;}
        .nav-item { color: #888; font-size: 11px; text-align: center; flex: 1; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
        #lock-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <div class="bg-animate"><div class="blob"></div></div>
    <div id="reward-feed"></div>

    <div id="lock-screen">
        <h1 style="color:var(--gold);">PENDING REDEMPTION</h1>
        <p>App locked until your ‚Ç¶100 Airtime Diamond is cleared.</p>
        <input type="text" id="admin-clear-input" class="btn-gold" style="background:rgba(255,255,255,0.1); color:#fff; width:80%; margin-bottom:15px;" placeholder="Clearance Code">
        <button class="btn-gold" style="background:var(--green);" onclick="clearDiamond()">Unlock App</button>
    </div>

    <div id="home" class="container active">
        <div id="user-display" style="color:var(--green); font-size:14px; font-weight:bold; height:20px;"></div>
        <div id="balance" style="font-size: 50px; font-weight: 900; color: var(--gold);">0</div>
        <div style="color: var(--dia); font-weight: bold; font-size: 20px;">üíé <span id="diamonds">0</span></div>
        <div style="color: #ccc; margin: 5px 0;">‚ö° <span id="energy">1000</span> / <span id="max-energy">1000</span></div>
        <div class="coin-wrap" style="perspective:1000px; margin: 20px 0;"><div class="coin-btn" id="coin">P</div></div>
        <button class="btn-gold" style="background: var(--dia); color: #004a5c;" onclick="runAdsgram()">üì∫ Watch Ad (+1,000)</button>
    </div>

    <div id="boost" class="container">
        <h2 style="color: var(--gold);">Upgrades</h2>
        <div class="glass-card"><h4>Tap Power (Lvl <span id="lvl-tap">1</span>)</h4><button class="btn-gold" onclick="upgrade('tap')">üí∞ <span id="cost-tap">1000</span></button></div>
        <div class="glass-card"><h4>Energy Tank (Lvl <span id="lvl-tank">1</span>)</h4><button class="btn-gold" onclick="upgrade('tank')">üí∞ <span id="cost-tank">1000</span></button></div>
        <div class="glass-card"><h4>Recharge Speed (Lvl <span id="lvl-speed">1</span>)</h4><button class="btn-gold" onclick="upgrade('speed')">üí∞ <span id="cost-speed">1000</span></button></div>
        <div class="glass-card"><button class="btn-gold" onclick="shareRef()">Invite Friend (+2k)</button></div>
    </div>

    <div id="pay" class="container">
        <h2 style="color: var(--gold);">Elite Status</h2>
        <div id="sub-active-view">
            <div class="glass-card" style="text-align:center;">
                <p>10x Power | ‚Ç¶200 / 3 Days</p><p style="color:var(--gold);">OPay: 8124647818</p>
                <button class="btn-gold" onclick="sendProof()">Message Admin</button>
            </div>
            <input type="text" id="secret-code" class="btn-gold" style="background:rgba(255,255,255,0.05); color:#fff;" placeholder="Unique Code">
            <input type="text" id="username-input" class="btn-gold" style="background:rgba(255,255,255,0.05); color:#fff;" placeholder="Username">
            <button class="btn-gold" style="background: var(--green);" onclick="strictSubscribe()">Activate</button>
        </div>
        <div id="sub-locked-view" style="display:none; color:var(--green); text-align:center;"><h3>‚úÖ ELITE ACTIVE</h3></div>
    </div>

    <div id="settings" class="container">
        <h2 style="color: var(--gold);">Redeem</h2>
        <div class="glass-card" style="text-align:center;">
            <p id="p-username" style="font-size: 20px; font-weight:bold; color:var(--green);">GUEST</p>
            <p style="font-size:12px;">Suffix: <span id="p-suffix"></span></p>
        </div>
        <button class="btn-gold" style="background:var(--dia); color:#000;" onclick="requestRedeem()">Request ‚Ç¶100 Airtime</button>
        <button class="btn-gold" style="background:var(--red); color:#fff; margin-top:20px;" onclick="factoryReset()">‚ö†Ô∏è Reset Account</button>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Tap</div>
        <div class="nav-item" onclick="showTab('boost', this)">üöÄ<br>Boost</div>
        <div class="nav-item" onclick="showTab('pay', this)">‚≠ê<br>Elite</div>
        <div class="nav-item" onclick="showTab('settings', this)">‚öôÔ∏è<br>Admin</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp; tg.ready(); tg.expand();
        const userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "00";
        const suffix = parseInt(String(userId).slice(-2));
        const AdController = window.Adsgram.init({ blockId: "22672" });

        let bal = parseInt(localStorage.getItem('bal_'+userId)) || 0;
        let diamonds = parseInt(localStorage.getItem('dia_'+userId)) || 0;
        let isPremium = localStorage.getItem('premium_'+userId) === 'true';
        let userNick = localStorage.getItem('nick_'+userId) || "GUEST";
        let subCount = parseInt(localStorage.getItem('subCount_'+userId)) || 1;
        let tapLvl = parseInt(localStorage.getItem('tapLvl_'+userId)) || 1;
        let tankLvl = parseInt(localStorage.getItem('tankLvl_'+userId)) || 1;
        let speedLvl = parseInt(localStorage.getItem('speedLvl_'+userId)) || 1;
        let eng = 1000, tapCounter = 0;

        function updateUI() {
            if (bal >= 20000) { bal = 0; diamonds++; triggerFeed(userNick, "earned a Diamond! üíé"); tg.showAlert("Diamond Earned!"); }
            const maxEng = 500 + (tankLvl * 500);
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = diamonds;
            document.getElementById('energy').innerText = eng;
            document.getElementById('max-energy').innerText = maxEng;
            document.getElementById('lvl-tap').innerText = tapLvl;
            document.getElementById('cost-tap').innerText = tapLvl * 1000;
            document.getElementById('lvl-tank').innerText = tankLvl;
            document.getElementById('cost-tank').innerText = tankLvl * 1000;
            document.getElementById('lvl-speed').innerText = speedLvl;
            document.getElementById('cost-speed').innerText = speedLvl * 1000;
            document.getElementById('p-username').innerText = userNick.toUpperCase();
            document.getElementById('p-suffix').innerText = suffix;
            document.getElementById('user-display').innerText = isPremium ? "üëë " + userNick.toUpperCase() : "";
            if (isPremium) {
                document.getElementById('sub-active-view').style.display = "none";
                document.getElementById('sub-locked-view').style.display = "block";
            }
            if (localStorage.getItem('locked_'+userId) === 'true') document.getElementById('lock-screen').style.display = 'flex';
            save();
        }

        function save() {
            localStorage.setItem('bal_'+userId, bal);
            localStorage.setItem('dia_'+userId, diamonds);
            localStorage.setItem('subCount_'+userId, subCount);
            localStorage.setItem('tapLvl_'+userId, tapLvl);
            localStorage.setItem('tankLvl_'+userId, tankLvl);
            localStorage.setItem('speedLvl_'+userId, speedLvl);
        }

        const coin = document.getElementById('coin');
        coin.addEventListener('pointerdown', (e) => {
            if (eng > 0) {
                const val = isPremium ? 10 : tapLvl; bal += val; eng--; tapCounter++; updateUI();
                const rect = coin.getBoundingClientRect();
                coin.style.transform = `perspective(1000px) rotateX(${-(e.clientY - rect.top - 140)/8}deg) rotateY(${(e.clientX - rect.left - 140)/8}deg) scale(0.92)`;
                if (tapCounter >= 4000) { tapCounter = 0; AdController.show().then(() => { bal += 1000; updateUI(); }); }
            }
        });
        coin.addEventListener('pointerup', () => coin.style.transform = "perspective(1000px) scale(1)");

        function runAdsgram() { AdController.show().then(() => { bal += 1000; updateUI(); }).catch(() => tg.showAlert("Ad busy.")); }

        function upgrade(type) {
            let cost = (type === 'tap' ? tapLvl : (type === 'tank' ? tankLvl : speedLvl)) * 1000;
            if (bal >= cost) {
                bal -= cost; if(type === 'tap') tapLvl++; else if(type === 'tank') tankLvl++; else speedLvl++; updateUI();
            } else tg.showAlert("Need more coins!");
        }

        function strictSubscribe() {
            const expected = "PRINCE2026" + (suffix * 4 + subCount * 12);
            if (document.getElementById('secret-code').value.trim() === expected) {
                userNick = document.getElementById('username-input').value.trim() || "ELITE";
                isPremium = true; subCount++; localStorage.setItem('premium_'+userId, 'true');
                localStorage.setItem('nick_'+userId, userNick); updateUI();
                tg.showAlert("Activated!");
            } else tg.showAlert("Invalid Code!");
        }

        function requestRedeem() {
            if (diamonds >= 1) {
                localStorage.setItem('locked_'+userId, 'true');
                window.open(`https://wa.me/2348124647818?text=Redeem Request. Suffix: ${suffix}`);
                updateUI();
            }
        }

        function clearDiamond() {
            if (document.getElementById('admin-clear-input').value.trim() === "Clear" + (suffix * 2)) {
                if (diamonds >= 1) {
                    diamonds--; localStorage.removeItem('locked_'+userId);
                    document.getElementById('lock-screen').style.display = 'none'; updateUI();
                    window.open(`https://wa.me/2348124647818?text=Diamond Cleared!`);
                }
            } else tg.showAlert("Wrong Code.");
        }

        function triggerFeed(n, a) {
            const f = document.getElementById('reward-feed'); f.innerText = `üéâ ${n.toUpperCase()} ${a}`;
            f.classList.add('show'); setTimeout(() => f.classList.remove('show'), 5000);
        }

        function sendProof() { window.open(`https://wa.me/2348124647818?text=Hello Admin, Upgrade Me. Suffix: ${suffix}, Attempt: #${subCount}`); }
        function shareRef() { tg.openTelegramLink(`https://t.me/share/url?url=https://t.me/CryptoTap_bot/play?startapp=${userId}&text=Join Crypto Tap!`); }
        function showTab(id, el) { 
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active'); el.classList.add('active');
        }
        function factoryReset() { localStorage.clear(); window.location.reload(); }
        
        setInterval(() => { if (eng < (500 + tankLvl * 500)) { eng += speedLvl; updateUI(); } }, 1000);
        updateUI();
        const names = ["Abigail", "Benson", "Chidi", "Dada", "Efe", "Femi", "Joy", "Kola", "Musa", "Ngozi", "Obi", "Sola", "Tunde", "Uche", "Victor", "Yemi", "Zainab"];
        const acts = ["just Subscribed!", "reached 20,000 Coins!", "swapped Diamond for Airtime!"];
        setInterval(() => { triggerFeed(names[Math.floor(Math.random()*names.length)], acts[Math.floor(Math.random()*acts.length)]); }, 15000);
    </script>
</body>
</html>
