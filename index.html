<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tap Master v57.6</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --purple: #a020f0; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); transition: 0.8s; }
        .nebula-bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -2; background: #010205; }
        .nebula-glow { position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; background: radial-gradient(circle, rgba(160,32,240,0.4) 0%, rgba(0,210,255,0.1) 40%, transparent 70%); opacity: 0; transition: 1.5s; z-index: -1; pointer-events: none; }
        body.boost-active .nebula-glow { opacity: 1; animation: supernova 3s infinite linear; }
        @keyframes supernova { 0% { transform: scale(1) rotate(0deg); } 100% { transform: scale(1.3) rotate(360deg); } }
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; width: 100%; }
        .container.active { display: flex; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* TAPSWAP-STYLE 3D COIN CSS */
        .coin-wrapper { perspective: 1000px; margin: 30px 0; z-index: 5; }
        .coin-btn { 
            width: 310px; height: 310px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            transition: transform 0.1s ease-out; 
            transform-style: preserve-3d; cursor: pointer;
            background-image: url('https://raw.githubusercontent.com/PrinceDavis/Assets/main/CustomCoin.png'); /* Replace with your actual hosted image link */
            background-size: cover;
            background-position: center;
            border: 10px solid #222;
            box-shadow: 0 30px 60px rgba(0,0,0,0.9), inset 0 0 30px rgba(255,255,255,0.1);
        }
        .coin-btn::after {
            content: ''; position: absolute; width: 100%; height: 100%;
            border-radius: 50%; transform: translateZ(-15px); 
            background: #111; border: 4px solid #333;
        }

        .tap-val { position: absolute; color: var(--gold); font-size: 35px; font-weight: 900; animation: floatUp 0.8s ease-out forwards; pointer-events: none; z-index: 1000; text-shadow: 0 0 10px #000; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-160px); } }
        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #221a04; padding: 16px; border-radius: 15px; font-weight: 800; border: none; width: 100%; margin-top: 10px; cursor: pointer; text-transform: uppercase; }
        .glass-card { background: rgba(255,255,255,0.06); border-radius: 18px; padding: 15px; width: 100%; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
        .nav { height: 85px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; z-index: 1000; }
        .nav-item { flex: 1; text-align: center; padding-top: 20px; color: #666; font-size: 10px; font-weight: bold; }
        .nav-item.active { color: var(--gold); }
        #bot-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; background: #111; border: 2px solid var(--gold); border-radius: 20px; z-index: 10000; padding: 25px; text-align: center; }
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; padding: 30px; }
        #ad-countdown { display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.85); border: 1px solid var(--gold); padding: 15px 30px; border-radius: 50px; z-index: 10001; font-weight: bold; color: var(--gold); pointer-events: none; }
    </style>
</head>
<body onload="initApp();">
    <div id="ad-countdown">NEXT AD IN: <span id="ad-timer-val">7</span>s</div>
    <div id="bot-modal">
        <h2 style="color:var(--gold); margin:0;">ü§ñ BOT EARNINGS</h2>
        <p id="bot-earned-msg" style="font-size:18px; margin:15px 0;"></p>
        <button class="btn-gold" onclick="closeBotModal()">CLAIM</button>
    </div>

    <div id="admin-panel">
        <h2 style="color:var(--gold);">ADMIN COMMAND</h2>
        <div class="glass-card"><p>ID Suffix: <span id="adm-suffix">--</span></p><p>Verification Salt: <span id="adm-salt">--</span></p></div>
        <button class="btn-gold" onclick="closeAdmin()">BACK TO GAME</button>
    </div>

    <div class="nebula-bg"><div class="nebula-glow"></div></div>

    <div id="home" class="container active">
        <div id="balance" onclick="adminTrigger()" style="font-size: 55px; font-weight: 900; color: var(--gold); cursor:pointer;">0</div>
        <div style="font-size: 20px; color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span></div>
        <div id="prem-timer" style="color:var(--green); font-weight:bold; font-size:12px; height:15px;"></div>
        <div class="coin-wrapper"><div class="coin-btn" id="coin"></div></div>
        <div id="boost-timer" style="color:var(--purple); font-weight:bold; height:20px;"></div>
        <div style="color:#777; font-size:12px;">‚ö° <span id="energy">1000</span> / 1000</div>
        <button class="btn-gold" style="background: var(--dia); color:#000;" onclick="showDoubleAd()">üì∫ WATCH ADS (+3,000)</button>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Home</div>
        <div class="nav-item" onclick="showTab('tasks', this)">üìã<br>Tasks</div>
        <div class="nav-item" onclick="showTab('shop', this)">‚ö°<br>Boost</div>
        <div class="nav-item" onclick="showTab('premium', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "0000";
        const suffix = uid.slice(-2);
        const v = "v3_"; 

        let bal = parseInt(localStorage.getItem(v+'bal_'+uid)) || 0;
        let dia = parseInt(localStorage.getItem(v+'dia_'+uid)) || 0;
        let salt = parseInt(localStorage.getItem(v+'salt_'+uid)) || 1;
        let hasBot = localStorage.getItem(v+'bot_'+uid) === 'true';
        let premExpiry = parseInt(localStorage.getItem(v+'premExp_'+uid)) || 0;
        let lastVisit = parseInt(localStorage.getItem(v+'lastVis_'+uid)) || Date.now();
        
        let adThreshold = 0, boosts = 2, eng = 1000, isBoosted = false, adminTaps = 0;
        const AdController = window.Adsgram.init({ blockId: "22672" });

        function initApp() { 
            checkAwayEarnings();
            updateUI(); 
            if(hasBot) startBot();
            setInterval(checkPremiumExpiry, 1000);
            document.addEventListener("visibilitychange", () => {
                if (document.visibilityState === 'visible') checkAwayEarnings();
                else localStorage.setItem(v+'lastVis_'+uid, Date.now());
            });
        }

        // ... checkAwayEarnings, isPrem, checkPremiumExpiry, updateUI remain identical to v57.5 ...

        function handleTap(e) {
            e.preventDefault();
            const touches = e.changedTouches;
            for (let i = 0; i < touches.length; i++) {
                if (eng > 0) {
                    let val = (isPrem() ? 20 : 1) * (isBoosted ? 5 : 1);
                    bal += val; eng--; adThreshold += val; 
                    
                    const valEl = document.createElement('div');
                    valEl.className = 'tap-val'; valEl.innerText = `+${val}`;
                    valEl.style.left = touches[i].clientX + 'px'; valEl.style.top = touches[i].clientY + 'px';
                    document.body.appendChild(valEl); setTimeout(() => valEl.remove(), 800);
                    
                    /* TAPSWAP-STYLE TILT PHYSICS */
                    const rect = document.getElementById('coin').getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    const offsetX = touches[i].clientX - centerX;
                    const offsetY = touches[i].clientY - centerY;
                    
                    // Tilt intensity: max 45 degrees for better 3D feel
                    const rotateY = (offsetX / (rect.width / 2)) * 45;
                    const rotateX = -(offsetY / (rect.height / 2)) * 45;
                    
                    document.getElementById('coin').style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg)`;
                    setTimeout(() => document.getElementById('coin').style.transform = "rotateY(0deg) rotateX(0deg)", 100);
                    
                    if(adThreshold >= 3000) { 
                        adThreshold = 0; 
                        AdController.show().then(() => {
                            bal += 500; updateUI(); tg.showAlert("Ad Verified! +500 Coins Bonus added. Good Job!");
                        });
                    }
                }
            }
            updateUI();
        }
        document.getElementById('coin').addEventListener('touchstart', handleTap);

        function showDoubleAd() {
            AdController.show().then(() => {
                let waitTime = 7;
                const overlay = document.getElementById('ad-countdown');
                const val = document.getElementById('ad-timer-val');
                overlay.style.display = 'block'; val.innerText = waitTime;
                const t = setInterval(() => {
                    waitTime--; val.innerText = waitTime;
                    if (waitTime <= 0) {
                        clearInterval(t); overlay.style.display = 'none';
                        AdController.show().then(() => {
                            bal += 3000; updateUI(); tg.showAlert("Congratulations, you have been rewarded 3000 coins, ü§ëüéâ. Good Job!");
                        });
                    }
                }, 1000);
            });
        }

        // ... Other functions (activateBoost, buyBot, startBot, etc.) remain identical to v57.5 ...
        
        function updateUI() {
            if (bal >= 50000) { bal -= 50000; dia++; confetti(); }
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('boost-count').innerText = boosts;
            document.getElementById('energy').innerText = eng;
            document.getElementById('p-suffix').innerText = suffix;
            document.getElementById('adm-suffix').innerText = suffix;
            document.getElementById('adm-salt').innerText = salt;
            localStorage.setItem(v+'bal_'+uid, bal);
            localStorage.setItem(v+'dia_'+uid, dia);
            localStorage.setItem(v+'salt_'+uid, salt);
            localStorage.setItem(v+'premExp_'+uid, premExpiry);
            localStorage.setItem(v+'bot_'+uid, hasBot);
            localStorage.setItem(v+'lastVis_'+uid, Date.now());
        }
    </script>
</body>
</html>
