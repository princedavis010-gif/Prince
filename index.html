<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tap: Empire v48.0</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --purple: #a020f0; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); transition: 0.8s; }

        .nebula-bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -2; background: #010205; overflow: hidden; }
        .nebula-glow { position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; background: radial-gradient(circle, rgba(160,32,240,0.4) 0%, rgba(0,210,255,0.1) 40%, transparent 70%); opacity: 0; transition: 1.5s; z-index: -1; pointer-events: none; }
        body.boost-active .nebula-glow { opacity: 1; animation: supernovaWarp 3s infinite linear; }
        @keyframes supernovaWarp { 0% { transform: scale(1) rotate(0deg); } 50% { transform: scale(1.3) rotate(180deg); } 100% { transform: scale(1) rotate(360deg); } }

        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; width: 100%; }
        .container.active { display: flex; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* LARGER 3D COIN */
        .coin-wrapper { perspective: 1000px; margin: 15px 0; }
        .coin-btn { width: 310px; height: 310px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 150px; font-weight: 900; transition: 0.1s; transform-style: preserve-3d; cursor: pointer; }
        .skin-gold { background: radial-gradient(circle, #ffe08a, #f3ba2f, #8e6d1a); border: 12px solid #3d2f07; color: #3d2f07; box-shadow: 0 15px 45px rgba(243,186,47,0.4); }

        .tap-val { position: absolute; color: var(--gold); font-size: 35px; font-weight: 900; animation: floatUp 0.8s ease-out forwards; pointer-events: none; z-index: 1000; text-shadow: 0 0 10px #000; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-160px); } }

        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #221a04; padding: 16px; border-radius: 15px; font-weight: 800; border: none; width: 100%; margin-top: 10px; cursor: pointer; text-transform: uppercase; }
        .glass-card { background: rgba(255,255,255,0.06); border-radius: 18px; padding: 15px; width: 100%; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.1); }
        .nav { height: 85px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; z-index: 1000; }
        .nav-item { flex: 1; text-align: center; padding-top: 20px; color: #666; font-size: 10px; font-weight: bold; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body onload="initApp();">
    <div class="nebula-bg"><div class="nebula-glow"></div></div>

    <div id="home" class="container active">
        <div id="balance" onclick="adminTrigger()" style="font-size: 55px; font-weight: 900; color: var(--gold);">0</div>
        <div style="font-size: 20px; color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span></div>
        <div style="font-size: 10px; color: #666;">(20,000 Coins = 1 Diamond = ‚Ç¶100)</div>
        
        <div class="coin-wrapper">
            <div class="coin-btn skin-gold" id="coin">P</div>
        </div>
        
        <div id="boost-timer" style="color:var(--purple); font-weight:bold; height:20px;"></div>
        <div style="color:#777; font-size:12px;">‚ö° <span id="energy">1000</span> / 1000</div>
        <button class="btn-gold" style="background: var(--dia); color:#000;" onclick="showAd()">üì∫ WATCH AD (+2,000)</button>
    </div>

    <div id="tasks" class="container">
        <h2 style="color:var(--gold);">TASKS</h2>
        <div class="glass-card">
            <p><b>TikTok Mission:</b> Follow @ogprincedavis5081, Like & Comment on all videos.</p>
            <button class="btn-gold" style="background:#ff0050; color:white;" onclick="doTask('tiktok', 10000)">GO TO TIKTOK (+10,000)</button>
        </div>
    </div>

    <div id="shop" class="container">
        <h2 style="color:var(--gold);">STORE</h2>
        <div class="glass-card">
            <h3>ü§ñ AUTO-TAP BOT</h3>
            <button class="btn-gold" id="bot-btn" onclick="buyBot()">BUY FOR 2 üíé</button>
        </div>
        <div class="glass-card">
            <h3>‚ö° WARP BOOST (5X)</h3>
            <p>Daily Left: <span id="boost-count">2</span>/2</p>
            <button class="btn-gold" id="boost-btn" style="background:var(--purple); color:white;" onclick="activateBoost()">ACTIVATE (20s)</button>
            <button class="btn-gold" id="boost-ad-btn" style="display:none; background:var(--dia); color:black;" onclick="showAdForBoost()">WATCH AD FOR +1 BOOST</button>
        </div>
        <div class="glass-card">
            <h3>üëÜ MULTI-TAP (Lvl <span id="lvl-tap">1</span>)</h3>
            <button class="btn-gold" onclick="buyUpgrade()">UPGRADE (1,000 Coins)</button>
        </div>
    </div>

    <div id="premium" class="container">
        <h2 style="color:var(--gold);">PREMIUM</h2>
        <div class="glass-card">
            <p>Premium Subscription: ‚Ç¶200</p>
            <p>OPay: <b>8124647818</b></p>
            <button class="btn-gold" onclick="openWA('Paying for Premium')">SEND PROOF</button>
        </div>
        <div class="glass-card">
            <input type="text" id="uname-input" class="btn-gold" style="background:#111; color:#fff; text-align:center;" placeholder="CHOOSE USERNAME">
            <input type="text" id="code-input" class="btn-gold" style="background:#111; color:#fff; text-align:center;" placeholder="CODE">
            <button class="btn-gold" style="background:var(--green);" onclick="activatePremium()">ACTIVATE 20X TAP</button>
        </div>
        <button class="btn-gold" style="background:var(--dia); color:#000;" onclick="requestRedeem()">REDEEM DIAMOND (‚Ç¶100)</button>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Home</div>
        <div class="nav-item" onclick="showTab('tasks', this)">üìã<br>Tasks</div>
        <div class="nav-item" onclick="showTab('shop', this)">‚ö°<br>Shop</div>
        <div class="nav-item" onclick="showTab('premium', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "GUEST";
        
        let bal = parseInt(localStorage.getItem('bal_'+uid)) || 0;
        let dia = parseInt(localStorage.getItem('dia_'+uid)) || 0;
        let tapLvl = parseInt(localStorage.getItem('tapLvl_'+uid)) || 1;
        let adThreshold = 0;
        let boosts = 2, eng = 1000, isBoosted = false, isPrem = localStorage.getItem('prem_'+uid)==='true';
        let userName = localStorage.getItem('uname_'+uid) || "GUEST";

        const AdController = window.Adsgram.init({ blockId: "22672" });

        function initApp() { updateUI(); }

        function updateUI() {
            if (bal >= 20000) { bal -= 20000; dia++; confetti(); }
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('lvl-tap').innerText = tapLvl;
            document.getElementById('boost-count').innerText = boosts;
            document.getElementById('energy').innerText = eng;
            localStorage.setItem('bal_'+uid, bal);
            localStorage.setItem('dia_'+uid, dia);
            localStorage.setItem('tapLvl_'+uid, tapLvl);
            localStorage.setItem('prem_'+uid, isPrem);
        }

        // MULTI-FINGER TAPPING & 3D TILT
        function handleTap(e) {
            e.preventDefault();
            const touches = e.changedTouches;
            for (let i = 0; i < touches.length; i++) {
                if (eng > 0) {
                    let v = (isPrem ? 20 : tapLvl) * (isBoosted ? 5 : 1);
                    bal += v; eng--; adThreshold++; 

                    const valEl = document.createElement('div');
                    valEl.className = 'tap-val'; valEl.innerText = `+${v}`;
                    valEl.style.left = `${touches[i].clientX}px`; valEl.style.top = `${touches[i].clientY}px`;
                    document.body.appendChild(valEl); setTimeout(() => valEl.remove(), 800);

                    const rect = document.getElementById('coin').getBoundingClientRect();
                    const x = ((touches[i].clientX - rect.left) / rect.width - 0.5) * 50;
                    const y = ((touches[i].clientY - rect.top) / rect.height - 0.5) * -50;
                    document.getElementById('coin').style.transform = `rotateY(${x}deg) rotateX(${y}deg) scale(0.94)`;
                    setTimeout(() => document.getElementById('coin').style.transform = "rotate(0) scale(1)", 100);

                    if(adThreshold >= 3000) { adThreshold = 0; showAd(); }
                }
            }
            updateUI();
        }
        document.getElementById('coin').addEventListener('touchstart', handleTap);

        function activateBoost() {
            if(boosts > 0 && !isBoosted) {
                boosts--; isBoosted = true;
                document.body.classList.add('boost-active');
                let sec = 20; // Changed to 20s
                const t = setInterval(() => {
                    sec--; document.getElementById('boost-timer').innerText = `WARP: ${sec}s`;
                    if(sec <= 0) { 
                        clearInterval(t); isBoosted = false; 
                        document.body.classList.remove('boost-active'); 
                        document.getElementById('boost-timer').innerText = ""; 
                        document.getElementById('boost-ad-btn').style.display = "block";
                        updateUI(); 
                    }
                }, 1000);
            } else { tg.showAlert("No boosts left today!"); }
        }

        function showAdForBoost() {
            AdController.show().then(() => { boosts++; document.getElementById('boost-ad-btn').style.display = "none"; updateUI(); tg.showAlert("1 Boost Added!"); });
        }

        function doTask(t, reward) {
            if(t === 'tiktok') window.open("https://www.tiktok.com/@ogprincedavis5081");
            setTimeout(() => { bal += reward; updateUI(); tg.showAlert("Task Verified! +10,000 Coins"); }, 5000);
        }

        function buyUpgrade() { if(bal >= 1000) { bal -= 1000; tapLvl++; updateUI(); } }
        function activatePremium() { if(document.getElementById('code-input').value === "Davis2026") { isPrem = true; userName = document.getElementById('uname-input').value || userName; updateUI(); tg.showAlert("üëë PREMIUM ACTIVE!"); } }
        function requestRedeem() { if(dia >= 1) { dia--; updateUI(); openWA(`Redeem Diamond for ‚Ç¶100. User: ${userName}`); } }
        function showAd() { AdController.show().then(() => { bal += 2000; updateUI(); }); }
        function openWA(m) { window.open(`https://wa.me/2348124647818?text=${m}`); }
        function showTab(id, el) { document.querySelectorAll('.container').forEach(c => c.classList.remove('active')); document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); document.getElementById(id).classList.add('active'); el.classList.add('active'); }
        setInterval(() => { if(eng < 1000) { eng++; updateUI(); } }, 1500);
    </script>
</body>
</html>
