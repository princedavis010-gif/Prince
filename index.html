<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Tap: Elite</title>
    <script src="https://adsgram.ai/sdk/v1/adman.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --red: #ff4444; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Inter', sans-serif; color: white; background: #0b0e11; user-select: none; -webkit-tap-highlight-color: transparent; touch-action: none; }
        .bg-animate { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; background: radial-gradient(circle at 50% 50%, #1c1f24 0%, #0b0e11 100%); }
        .blob { position: absolute; width: 350px; height: 350px; background: linear-gradient(135deg, rgba(243, 186, 47, 0.1), rgba(0, 210, 255, 0.1)); filter: blur(90px); border-radius: 50%; animation: move 20s infinite alternate; }
        @keyframes move { from { transform: translate(-20%, -20%); } to { transform: translate(20%, 20%); } }
        #reward-feed { position: absolute; top: -60px; left: 50%; transform: translateX(-50%); width: 85%; background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px); padding: 10px; border-radius: 12px; font-size: 11px; font-weight: bold; color: var(--dia); transition: top 0.5s; z-index: 4000; text-align: center; }
        #reward-feed.show { top: 15px; }
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; }
        .container.active { display: flex; }
        .btn-gold { background: linear-gradient(to bottom, #f3ba2f, #bf9524); color: #403108; padding: 15px; border-radius: 14px; font-weight: 800; border: none; width: 95%; text-transform: uppercase; cursor: pointer; margin-top: 10px; box-shadow: 0 5px 0 #8e6d1a; transition: transform 0.05s; }
        .btn-gold:active { transform: translateY(4px); box-shadow: 0 1px 0 #8e6d1a; }
        .glass-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); width: 90%; padding: 15px; border-radius: 18px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 12px; }
        .coin-btn { width: 280px; height: 280px; background: radial-gradient(circle at 30% 30%, #ffe08a 0%, #f3ba2f 40%, #bf9524 100%); border-radius: 50%; border: 4px solid #5c4711; outline: 8px solid var(--gold); outline-offset: -12px; box-shadow: 0 20px 40px rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; font-size: 130px; color: #5c4711; font-weight: 900; transition: transform 0.1s; }
        .tap-anim { position: absolute; color: white; font-size: 38px; font-weight: 900; pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 1000; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-150px) scale(1.5); } }
        .nav { height: 75px; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(20px); display: flex; justify-content: space-around; align-items: center; position: fixed; bottom: 0; width: 100%; border-top: 1px solid rgba(255, 255, 255, 0.1); z-index: 3000;}
        .nav-item { color: #888; font-size: 11px; text-align: center; flex: 1; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body>
    <div class="bg-animate"><div class="blob"></div></div>
    <div id="reward-feed"></div>

    <div id="home" class="container active">
        <div id="user-display" style="color:var(--green); font-size:14px; font-weight:bold;"></div>
        <div id="balance" style="font-size: 50px; font-weight: 900; color: var(--gold);">0</div>
        <div style="color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span> Diamonds</div>
        <div style="color: #ccc; margin: 5px 0;">‚ö° <span id="energy">1000</span> / <span id="max-energy">1000</span></div>
        <div id="sub-timer" style="color: var(--red); font-size: 11px; display: none;">Elite Expires: <span id="exp-clock"></span></div>
        <div class="coin-wrap" style="perspective:1000px; margin: 20px 0;"><div class="coin-btn" id="coin">C</div></div>
        <button class="btn-gold" style="background: var(--dia); color: #004a5c;" onclick="runAd()">üì∫ Watch Ad (+1,000)</button>
    </div>

    <div id="boost" class="container">
        <h2 style="color: var(--gold);">Boosters</h2>
        <div class="glass-card">
            <h4 style="margin:0; color:var(--green);">Daily Free Rewards</h4>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button class="btn-gold" style="font-size:10px; margin:0;" onclick="useDaily('turbo')">üöÄ Turbo (<span id="d-turbo">4</span>)</button>
                <button class="btn-gold" style="font-size:10px; margin:0; background:var(--dia);" onclick="useDaily('refill')">‚ö° Refill (<span id="d-refill">3</span>)</button>
            </div>
        </div>
        <div class="glass-card">
            <h4 style="color: var(--dia); margin:0;">Perfect Referral</h4>
            <button class="btn-gold" onclick="shareRef()">Invite Friend</button>
            <button id="claim-ref-btn" class="btn-gold" style="background:var(--green); display:none;" onclick="claimReferral()">üéÅ Claim 2k Bonus</button>
        </div>
    </div>

    <div id="pay" class="container">
        <h2 style="color: var(--gold);">Elite Status</h2>
        <div id="sub-active-view">
            <div class="glass-card" style="text-align:center;">
                <p><b>Elite:</b> 10x Tap Power</p>
                <p style="color: var(--gold); font-size: 18px; font-weight: bold;">Price: ‚Ç¶200 for 3 Days</p>
                <p>OPay: 8124647818</p>
                <button class="btn-gold" onclick="sendProof()">Message Admin Proof</button>
            </div>
            <input type="text" id="secret-code" class="btn-gold" style="background:rgba(0,0,0,0.5); color:#fff; border: 1px solid #333;" placeholder="Unique Code">
            <input type="text" id="username-input" class="btn-gold" style="background:rgba(0,0,0,0.5); color:#fff; border: 1px solid #333;" placeholder="Username">
            <button class="btn-gold" style="background: var(--green);" onclick="strictSubscribe()">Activate 3 Days</button>
        </div>
        <div id="sub-locked-view" style="display:none; color:var(--green); text-align:center;"><h3>‚úÖ ELITE ACTIVE</h3></div>
    </div>

    <div id="settings" class="container">
        <h2 style="color: var(--gold);">Cashout</h2>
        <div class="glass-card" style="text-align:center;">
            <p id="p-username" style="font-size: 22px; color: var(--green); font-weight: bold;">GUEST</p>
        </div>
        <div class="glass-card" style="text-align:center;">
            <button class="btn-gold" style="background: var(--dia); color:#000;" onclick="requestRedeem()">Request Airtime (‚Ç¶100)</button>
            <div style="margin-top:15px; display:flex; gap:5px;">
                <input type="text" id="admin-clear-input" class="btn-gold" style="background:rgba(0,0,0,0.5); color:#fff; flex:2; margin:0;" placeholder="Clearance Code">
                <button class="btn-gold" style="background:var(--green); flex:1; margin:0;" onclick="clearDiamond()">Clear</button>
            </div>
        </div>
        <button class="btn-gold" style="background:var(--red); color:#fff; margin-top:20px;" onclick="factoryReset()">‚ö†Ô∏è Reset App</button>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Tap</div>
        <div class="nav-item" onclick="showTab('boost', this)">üöÄ<br>Boost</div>
        <div class="nav-item" onclick="showTab('pay', this)">‚≠ê<br>Elite</div>
        <div class="nav-item" onclick="showTab('settings', this)">‚öôÔ∏è<br>Admin</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();
        const userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "00";
        const suffix = parseInt(String(userId).slice(-2));
        const BOT_USERNAME = "CryptoTap_bot";

        let bal = parseInt(localStorage.getItem('bal_'+userId)) || 0;
        let diamonds = parseInt(localStorage.getItem('dia_'+userId)) || 0;
        let isPremium = localStorage.getItem('premium_'+userId) === 'true';
        let userNick = localStorage.getItem('nick_'+userId) || "GUEST";
        let subExpiry = parseInt(localStorage.getItem('subExp_'+userId)) || 0;
        let subCount = parseInt(localStorage.getItem('subCount_'+userId)) || 1;
        let eng = 1000, tapCounter = parseInt(localStorage.getItem('tCount_'+userId)) || 0;
        let dTurbo = 4, dRefill = 3;

        function updateUI() {
            checkDailyReset();
            const now = new Date().getTime();
            if (isPremium && subExpiry > 0 && now > subExpiry) {
                isPremium = false; localStorage.setItem('premium_'+userId, 'false');
                tg.showAlert("Elite Status Expired!");
            }
            if (bal >= 20000) { bal = 1; diamonds += 1; triggerFeed(userNick, "reached 20,000 Coins & earned a Diamond!"); tg.showAlert("üíé 20k Coins converted!"); }
            if (bal >= 40000) triggerFeed(userNick, "reached 40,000 Coins!");

            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = diamonds;
            document.getElementById('energy').innerText = eng;
            document.getElementById('d-turbo').innerText = dTurbo;
            document.getElementById('d-refill').innerText = dRefill;
            document.getElementById('p-username').innerText = userNick.toUpperCase();
            document.getElementById('user-display').innerText = isPremium ? "üëë " + userNick.toUpperCase() : "";
            
            if (isPremium) {
                document.getElementById('sub-active-view').style.display = "none";
                document.getElementById('sub-locked-view').style.display = "block";
                document.getElementById('sub-timer').style.display = "block";
                const diff = subExpiry - now;
                document.getElementById('exp-clock').innerText = `${Math.floor(diff / (1000 * 60 * 60 * 24))}d ${Math.floor((diff % 86400000) / 3600000)}h`;
            } else {
                document.getElementById('sub-active-view').style.display = "block";
                document.getElementById('sub-locked-view').style.display = "none";
                document.getElementById('sub-timer').style.display = "none";
            }
            localStorage.setItem('bal_'+userId, bal); localStorage.setItem('dia_'+userId, diamonds); localStorage.setItem('subCount_'+userId, subCount); localStorage.setItem('tCount_'+userId, tapCounter);
        }

        function checkDailyReset() {
            const today = new Date().toISOString().split('T')[0];
            if (new Date().getHours() >= 3 && localStorage.getItem('lastReset_'+userId) !== today) {
                dTurbo = 4; dRefill = 3; localStorage.setItem('lastReset_'+userId, today);
            }
        }

        function triggerFeed(name, action) {
            const feed = document.getElementById('reward-feed');
            feed.innerText = `üéâ Member ${name.toUpperCase()} ${action}`;
            feed.classList.add('show'); setTimeout(() => feed.classList.remove('show'), 5000);
        }

        function strictSubscribe() {
            const code = "Crypto" + (suffix * 3 + subCount * 7 + 2026);
            if (document.getElementById('secret-code').value.trim() === code) {
                userNick = document.getElementById('username-input').value.trim() || "ELITE";
                isPremium = true; subCount++; subExpiry = new Date().getTime() + 259200000;
                localStorage.setItem('premium_'+userId, 'true'); localStorage.setItem('nick_'+userId, userNick); localStorage.setItem('subExp_'+userId, subExpiry);
                triggerFeed(userNick, "just Subscribed for 3 Days!"); updateUI(); tg.showAlert("Elite Activated!");
            } else tg.showAlert("Wrong Code!");
        }

        function requestRedeem() {
            if (diamonds >= 1) {
                const txId = "PT-" + Math.floor(Math.random() * 900 + 100) + (suffix + 10);
                window.open(`https://wa.me/2348124647818?text=REDEEM REQUEST%0AUser: ${userNick}%0ATXID: ${txId}`);
                tg.showAlert("Request Sent!");
            } else tg.showAlert("Need 1 Diamond!");
        }

        function clearDiamond() {
            if (document.getElementById('admin-clear-input').value.trim() === "Clear" + (suffix * 2)) {
                if (diamonds >= 1) {
                    diamonds -= 1; updateUI(); triggerFeed(userNick, "swapped Diamond for Airtime!");
                    tg.showAlert("‚úÖ Success!"); setTimeout(() => window.open(`https://wa.me/2348124647818?text=I successfully swapped my Diamond in Crypto Tap!`), 2000);
                }
            } else tg.showAlert("Invalid Code!");
        }

        const coin = document.getElementById('coin');
        coin.addEventListener('pointerdown', (e) => {
            if (eng > 0) {
                const val = isPremium ? 10 : 1; bal += val; eng--; tapCounter++; updateUI();
                const float = document.createElement('div'); float.className = 'tap-anim'; float.innerText = '+' + val;
                float.style.left = e.clientX + 'px'; float.style.top = e.clientY + 'px'; document.body.appendChild(float); setTimeout(() => float.remove(), 800);
                const rect = coin.getBoundingClientRect();
                coin.style.transform = `perspective(1000px) rotateX(${-(e.clientY - rect.top - 140)/8}deg) rotateY(${(e.clientX - rect.left - 140)/8}deg) scale(0.92)`;
                if (tapCounter >= 4000) {
                    tapCounter = 0; tg.showAlert("Milestone! Ad Bonus: +1,000.");
                    window.Adsgram.init({ blockId: "22672" }).show().then(() => { bal += 1000; updateUI(); });
                }
            }
        });
        coin.addEventListener('pointerup', () => coin.style.transform = "perspective(1000px) scale(1)");

        const urlParams = new URLSearchParams(window.location.search);
        const refId = tg.initDataUnsafe.start_param || urlParams.get('startapp');
        if (refId && !localStorage.getItem('refClaimed_'+userId)) document.getElementById('claim-ref-btn').style.display = 'block';
        function claimReferral() { bal += 2000; localStorage.setItem('refClaimed_'+userId, 'true'); document.getElementById('claim-ref-btn').style.display = 'none'; updateUI(); }
        
        function shareRef() { tg.openTelegramLink(`https://t.me/share/url?url=https://t.me/${BOT_USERNAME}/play?startapp=${userId}&text=Join Crypto Tap!`); }
        function sendProof() { window.open(`https://wa.me/2348124647818?text=Hello Admin, I paid ‚Ç¶200 for 3 days of Elite. (Suffix: ${suffix}, Attempt: #${subCount})`); }
        function showTab(id, el) { document.querySelectorAll('.container').forEach(c => c.classList.remove('active')); document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); document.getElementById(id).classList.add('active'); el.classList.add('active'); }
        function runAd() { window.Adsgram.init({ blockId: "22672" }).show().then(() => { bal += 1000; updateUI(); }); }
        function useDaily(t) { if(t==='turbo'){ dTurbo--; tg.showAlert("Turbo Active!"); } else { dRefill--; eng=1000; } updateUI(); }
        function factoryReset() { localStorage.clear(); window.location.reload(); }

        setInterval(() => { if (eng < 1000) { eng += 1; updateUI(); } }, 1000);
        setInterval(() => { if (isPremium) { bal += 10; updateUI(); } }, 1000);
        updateUI();
        setInterval(() => { triggerFeed(namesPool[Math.floor(Math.random()*17)], actionsPool[Math.floor(Math.random()*4)]); }, 15000);
        const namesPool = ["Abigail", "Benson", "Chidi", "Dada", "Efe", "Femi", "Joy", "Kola", "Musa", "Ngozi", "Obi", "Sola", "Tunde", "Uche", "Victor", "Yemi", "Zainab"];
        const actionsPool = ["just Subscribed!", "reached 20,000 Coins!", "reached 40,000 Coins!", "swapped Diamond for Airtime!"];
    </script>
</body>
</html>
