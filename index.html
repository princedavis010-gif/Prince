<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto_Tap v102.0</title>
    
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    
    <script src='//libtl.com/sdk.js' data-zone='10611291' data-sdk='show_10611291'></script>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --purple: #a020f0; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); }
        
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 110px; }
        .container.active { display: flex; }

        .coin-wrapper { perspective: 1000px; margin: 30px 0; z-index: 5; }
        .coin-btn { 
            width: 310px; height: 310px; border-radius: 50%; 
            transition: transform 0.1s ease-out; transform-style: preserve-3d; cursor: pointer;
            background-image: url('https://raw.githubusercontent.com/princedavis010-gif/Prince/refs/heads/main/IMG-20260212-WA0024.jpg');
            background-size: cover; background-position: center; border: 5px solid rgba(255,255,255,0.1);
        }

        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #221a04; padding: 15px; border-radius: 12px; font-weight: 800; border: none; width: 100%; margin: 5px 0; cursor: pointer; text-transform: uppercase; }
        .glass-card { background: rgba(255,255,255,0.06); border-radius: 15px; padding: 15px; width: 100%; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }

        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; max-width: 300px; margin: 15px 0; }
        .box { height: 90px; background: #111; border: 1px solid var(--gold); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; }

        .nav { height: 85px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; }
        .nav-item { flex: 1; text-align: center; padding-top: 18px; color: #555; font-size: 11px; font-weight: bold; cursor: pointer; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body onload="initApp()">

    <div id="home" class="container active">
        <div id="balance" style="font-size: 50px; font-weight: 900; color: var(--gold);">0</div>
        <div style="color: var(--dia); font-size: 20px; margin-bottom: 5px;">üíé <span id="diamonds">0</span></div>
        <div class="coin-wrapper"><div class="coin-btn" id="coin" onpointerdown="handleTap(event)"></div></div>
        <div style="font-weight: bold;">‚ö° <span id="energy">1000</span> / 1000</div>
        <button class="btn-gold" style="background: var(--dia); margin-top: 20px;" onclick="showBellaAd()">üì∫ FREE 3,000 COINS</button>
    </div>

    <div id="grid-tab" class="container">
        <h2 style="color:var(--gold);">MYSTERY SQUARE</h2>
        <div class="grid">
            <div class="box" onclick="openBox(1)">?</div><div class="box" onclick="openBox(2)">?</div><div class="box" onclick="openBox(3)">?</div>
            <div class="box" onclick="openBox(4)">?</div><div class="box" onclick="openBox(5)">?</div><div class="box" onclick="openBox(6)">?</div>
            <div class="box" onclick="openBox(7)">?</div><div class="box" onclick="openBox(8)">?</div><div class="box" onclick="openBox(9)">?</div>
        </div>
        <div class="glass-card"><h3>üë• REFERRAL</h3><button class="btn-gold" style="background:var(--purple); color:#fff;" onclick="share()">INVITE FRIENDS (+40,000)</button></div>
    </div>

    <div id="shop" class="container">
        <h2 style="color:var(--gold);">BOOSTERS</h2>
        <div class="glass-card">
            <h3>ü§ñ AUTO-FARM BOT</h3>
            <p id="bot-status" style="font-size: 12px; color: #888;">OFFLINE</p>
            <button id="bot-btn" class="btn-gold" onclick="botAction()">BUY FOR 15,000</button>
        </div>
    </div>

    <div id="elite" class="container">
        <h2 style="color:var(--gold);">ELITE SHOP</h2>
        <div class="glass-card"><p style="font-size:22px;">ID: <span id="u-suffix">----</span></p><button class="btn-gold" onclick="document.getElementById('file').click()">üìÅ UPLOAD RECEIPT</button><input type="file" id="file" style="display:none;" onchange="tg.showAlert('Uploaded!')"></div>
        <div class="glass-card" onclick="adminTrigger()"><h4 id="activity-label">üìú RECENT ACTIVITY</h4>
            <div id="admin-panel" style="display:none; padding-top:15px; border-top:1px solid #333;">
                <input type="text" id="adm-s" placeholder="User Suffix" style="width:70%; padding:8px;"><br>
                <button class="btn-gold" style="font-size:12px; width:60%;" onclick="gen()">GENERATE CODE</button>
                <p id="res" style="color:var(--green);"></p>
            </div>
        </div>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="tab('home', this)">ü™ô<br>Home</div>
        <div class="nav-item" onclick="tab('grid-tab', this)">üìã<br>Grid</div>
        <div class="nav-item" onclick="tab('shop', this)">‚ö°<br>Boost</div>
        <div class="nav-item" onclick="tab('elite', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp; 
        const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "0000";
        const suffix = uid.slice(-4);
        const v = "v102_";

        let bal = parseInt(localStorage.getItem(v+'bal')) || 0;
        let dia = parseInt(localStorage.getItem(v+'dia')) || 0;
        let eng = parseInt(localStorage.getItem(v+'eng')) || 1000;
        let hasBot = localStorage.getItem(v+'bot') === 'true';
        let botUntil = parseInt(localStorage.getItem(v+'botT')) || 0;
        let adCount = 0;

        const Adsgram = window.Adsgram.init({ blockId: "22672" });

        function initApp() {
            updateUI();
            tg.expand();
            setInterval(() => { if(eng < 1000) { eng++; updateUI(); } }, 2500);
            setInterval(() => { if(hasBot && Date.now() < botUntil) { bal += 10; updateUI(); } }, 4000);
            
            // Preload Monetag to initialize the connection
            if(typeof show_10611291 === 'function') {
                show_10611291({ type: 'preload', telegram_id: uid });
            }
        }

        // --- VERIFIED MONETAG AD CALL ---
        async function showBellaAd() {
            if (typeof show_10611291 === 'function') {
                try {
                    // This pauses the script until the ad is confirmed by Monetag backend
                    const result = await show_10611291({ telegram_id: uid });
                    
                    // MUST check for 'valued' to ensure you get paid and stats update
                    if (result && result.reward_event_type === 'valued') {
                        bal += 3000; 
                        updateUI();
                        tg.showAlert("Success! +3,000 Coins added. üí∞");
                    } else {
                        // Users often see this if they skip or if inventory is 'low quality'
                        tg.showAlert("Ad seen, but reward verification failed. Try again!");
                    }
                    
                    // Reload for next time
                    show_10611291({ type: 'preload', telegram_id: uid });

                } catch (e) {
                    tg.showAlert("Ad closed too early or failed.");
                }
            } else {
                tg.showAlert("Ad System not ready.");
            }
        }

        function handleTap(e) {
            if(eng <= 0) return;
            bal++; eng--; adCount++;
            const t = e.changedTouches ? e.changedTouches[0] : e;
            const r = document.getElementById('coin').getBoundingClientRect();
            const x = ((t.clientX - (r.left + r.width/2)) / (r.width/2)) * 20;
            const y = -((t.clientY - (r.top + r.height/2)) / (r.height/2)) * 20;
            document.getElementById('coin').style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
            setTimeout(() => document.getElementById('coin').style.transform = "rotateY(0deg) rotateX(0deg)", 80);
            
            if(adCount >= 5000) { adCount = 0; Adsgram.show().then(() => { bal += 500; updateUI(); }); }
            updateUI();
        }

        function openBox(n) {
            if(n === 1 || n === 9) { tg.showAlert("Empty!"); } 
            else { bal += 200; updateUI(); tg.showAlert("Winner! +200 Coins."); }
        }

        function botAction() {
            const now = Date.now();
            if(!hasBot) { if(bal >= 15000) { bal -= 15000; hasBot = true; updateUI(); } } 
            else if(now > botUntil) {
                botUntil = now + (12 * 60 * 60 * 1000);
                tg.showAlert("You have successfully reactivate your auto farming bot. Good job! üéâ");
                updateUI();
            }
        }

        function updateUI() {
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('energy').innerText = eng;
            document.getElementById('u-suffix').innerText = suffix;
            
            const bBtn = document.getElementById('bot-btn');
            if(!hasBot) bBtn.innerText = "BUY FOR 15,000";
            else if(Date.now() > botUntil) { bBtn.innerText = "ACTIVATE"; bBtn.style.background = "var(--green)"; }
            else { bBtn.innerText = "FARMING..."; bBtn.style.background = "#444"; }

            localStorage.setItem(v+'bal', bal);
            localStorage.setItem(v+'dia', dia);
            localStorage.setItem(v+'eng', eng);
            localStorage.setItem(v+'bot', hasBot);
            localStorage.setItem(v+'botT', botUntil);
        }

        function tab(t, el) {
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.getElementById(t).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        let cl = 0; function adminTrigger() { cl++; if(cl===3) { if(prompt("Pass:")==="DavisAdmin2026") document.getElementById('admin-panel').style.display='block'; cl=0; } }
        function gen() { 
            const s = document.getElementById('adm-s').value; 
            document.getElementById('res').innerText = `DVS-${(parseInt(s)+777).toString(16).toUpperCase()}-${s}`; 
        }
        function share() { tg.showAlert("Link Copied!"); }
    </script>
</body>
</html>
