<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto_Tap v65.0</title>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #f3ba2f; --green: #00ff88; --dia: #00d2ff; --bg: #010205; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; touch-action: manipulation; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; font-family: 'Segoe UI', sans-serif; color: white; background: var(--bg); }
        .container { flex: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 100px; width: 100%; }
        .container.active { display: flex; animation: fadeIn 0.3s ease; }
        
        /* 3D COIN PHYSICS */
        .coin-wrapper { perspective: 1000px; margin: 30px 0; z-index: 5; }
        .coin-btn { 
            width: 280px; height: 280px; border-radius: 50%; 
            transition: transform 0.1s ease-out; transform-style: preserve-3d;
            background-image: url('https://raw.githubusercontent.com/princedavis010-gif/Prince/refs/heads/main/IMG-20260212-WA0024.jpg');
            background-size: cover; border: none; box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        .btn-gold { background: linear-gradient(135deg, var(--gold), #bf9524); color: #000; padding: 15px; border-radius: 12px; font-weight: 800; border: none; width: 100%; margin-top: 8px; cursor: pointer; }
        .btn-active-grey { background: #444 !important; color: #777 !important; cursor: not-allowed; }
        .glass-card { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 15px; width: 100%; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
        
        /* MYSTERY GRID */
        .mystery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 10px; width: 100%; }
        .box { background: #1a1a1a; border: 1.5px solid var(--gold); height: 75px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        .nav { height: 80px; background: #000; display: flex; position: fixed; bottom: 0; width: 100%; border-top: 1px solid #222; }
        .nav-item { flex: 1; text-align: center; padding-top: 15px; color: #555; font-size: 11px; font-weight: bold; }
        .nav-item.active { color: var(--gold); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body onload="initApp();">

    <div id="home" class="container active">
        <div id="balance" style="font-size: 45px; font-weight: 900; color: var(--gold);">0</div>
        <div style="color: var(--dia); font-weight: bold;">üíé <span id="diamonds">0</span></div>
        <div id="prem-timer" style="color:var(--green); font-size:13px; margin-top:5px;"></div>
        <div class="coin-wrapper" id="coin-area">
            <div class="coin-btn" id="coin" onpointerdown="handleTap(event)"></div>
        </div>
        <div style="color:#888; font-size:13px;">‚ö° <span id="energy">1000</span> / <span id="max-energy">1000</span></div>
        <button class="btn-gold" style="background:var(--green); margin-top:15px;" onclick="claimDaily()">üìÖ DAILY CHECK-IN</button>
    </div>

    <div id="upgrades" class="container">
        <h2 style="color:var(--gold);">UPGRADES</h2>
        <div class="glass-card">
            <h3>Increase Energy Tier</h3>
            <button class="btn-gold" style="background:var(--dia);" onclick="upgradeEnergy()">
                UPGRADE<br><span style="font-size:12px; font-weight:400;">Cost: <span id="eng-cost">2000</span></span>
            </button>
        </div>
        <div class="glass-card">
            <h3>Increase Tap Value</h3>
            <button class="btn-gold" onclick="upgradeTap()">
                UPGRADE<br><span style="font-size:12px; font-weight:400;">Cost: <span id="tap-cost">2000</span></span>
            </button>
        </div>
    </div>

    <div id="tasks" class="container">
        <h2 style="color:var(--gold);">TASKS</h2>
        <div class="glass-card"><h3>INVITE FRIENDS</h3><button class="btn-gold" onclick="inviteFriends()">INVITE & GET 40,000</button></div>
        <div class="glass-card"><h3>WATCH AD</h3><button class="btn-gold" style="background:var(--purple);" onclick="showAd()">GET 3,000 COINS</button></div>
        <div class="glass-card"><h3>üéÅ MYSTERY SQUARE (5k)</h3>
            <div class="mystery-grid" id="mystery-grid">
                <div class="box" onclick="openBox(0)">?</div><div class="box" onclick="openBox(1)">?</div><div class="box" onclick="openBox(2)">?</div>
                <div class="box" onclick="openBox(3)">?</div><div class="box" onclick="openBox(4)">?</div><div class="box" onclick="openBox(5)">?</div>
                <div class="box" onclick="openBox(6)">?</div><div class="box" onclick="openBox(7)">?</div><div class="box" onclick="openBox(8)">?</div>
            </div>
        </div>
    </div>

    <div id="elite" class="container">
        <h2 style="color:var(--gold);">ELITE</h2>
        <div class="glass-card">
            <p style="font-weight:bold;">ID: <span id="p-suffix">--</span></p>
            <p>Premium 20x Tap | OPay: 8124647818</p>
            <label for="receipt-upload" class="btn-gold">üìÅ UPLOAD RECEIPT</label>
            <input type="file" id="receipt-upload" style="display:none;" onchange="uploadReceipt()">
        </div>
        <div class="glass-card">
            <input type="text" id="code-input" class="btn-gold" style="background:#000; color:#fff;" placeholder="ENTER CODE">
            <button class="btn-gold" style="background:var(--green);" onclick="activatePremium()">ACTIVATE</button>
        </div>
        <div class="glass-card"><h3>ü§ñ AUTO-TAP BOT</h3><button id="bot-btn" class="btn-gold" onclick="buyBot()">PURCHASE FOR 15,000</button></div>
        <div class="glass-card" onclick="handleAdminTap()">üìú RECENT ACTIVITY</div>
        <div id="admin-box" style="display:none;" class="glass-card">
            <input type="text" id="adm-suffix" placeholder="Suffix"><input type="number" id="adm-salt" placeholder="Salt">
            <button class="btn-gold" onclick="generateAdminCode()">GENERATE</button>
            <p id="gen-result" style="font-size:10px;"></p>
        </div>
    </div>

    <div class="nav">
        <div class="nav-item active" onclick="showTab('home', this)">ü™ô<br>Home</div>
        <div class="nav-item" onclick="showTab('upgrades', this)">‚ö°<br>Upgrades</div>
        <div class="nav-item" onclick="showTab('tasks', this)">üìã<br>Tasks</div>
        <div class="nav-item" onclick="showTab('elite', this)">‚≠ê<br>Elite</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp; const uid = tg.initDataUnsafe.user ? String(tg.initDataUnsafe.user.id) : "0000";
        const suffix = uid.slice(-4); const v = "v65_"; 
        const botToken = "8494916372:AAHnNbLt8lykAKqUuGLIZnY0BBoC6UB0qbI";
        const chatId = "-1003843441800"; const secretKey = 777;
        const clickSnd = new Audio('https://www.soundjay.com/buttons/sounds/button-50.mp3');

        let bal = parseInt(localStorage.getItem(v+'bal')) || 0; let dia = parseInt(localStorage.getItem(v+'dia')) || 0;
        let hasBot = localStorage.getItem(v+'hasBot') === 'true'; let botExp = parseInt(localStorage.getItem(v+'botExp')) || 0;
        let premExp = parseInt(localStorage.getItem(v+'premExp')) || 0; let maxEng = parseInt(localStorage.getItem(v+'maxEng')) || 1000;
        let eng = maxEng; let tapLvl = parseInt(localStorage.getItem(v+'tapLvl')) || 1; let streak = parseInt(localStorage.getItem(v+'streak')) || 0;
        let salt = parseInt(localStorage.getItem(v+'salt')) || 1;

        function initApp() { updateUI(); apply3D(); setInterval(tick, 1000); }

        // 3D TILT PHYSICS (20 DEGREES)
        function apply3D() {
            const el = document.getElementById('coin');
            el.addEventListener('pointermove', (e) => {
                const r = el.getBoundingClientRect();
                const x = e.clientX - r.left - r.width/2; const y = e.clientY - r.top - r.height/2;
                el.style.transform = `rotateX(${(y/(r.height/2))*-20}deg) rotateY(${(x/(r.width/2))*20}deg)`;
            });
            el.addEventListener('pointerleave', () => el.style.transform = 'rotateX(0) rotateY(0)');
        }

        function handleTap(e) {
            if(eng <= 0) return; clickSnd.currentTime = 0; clickSnd.play();
            let val = tapLvl * (premExp > Date.now() ? 20 : 1); bal += val; eng--;
            if(bal >= 20000 && !localStorage.getItem(v+'v20k')) { navigator.vibrate([200,100,200]); localStorage.setItem(v+'v20k', 't'); }
            updateUI();
        }

        // RIGGED MYSTERY SQUARE (Far-apart Diamonds)
        function openBox(idx) {
            if(bal < 5000) return; bal -= 5000;
            let winIdx = Math.floor(Math.random() * 6) + 1; // Cannot be 0 or 8
            const boxes = document.querySelectorAll('.box');
            boxes.forEach((b, i) => {
                if(i === 0) b.innerText = "1üíé"; else if(i === 8) b.innerText = "2üíé"; else b.innerText = "500ü™ô";
                if(i === winIdx) { b.style.background = "var(--green)"; bal += 500; }
            });
            setTimeout(() => { boxes.forEach(b => {b.innerText="?"; b.style.background="#1a1a1a";}); updateUI(); }, 2000);
        }

        function buyBot() {
            if(!hasBot && bal >= 15000) {
                bal -= 15000; hasBot = true; localStorage.setItem(v+'hasBot', true);
                tg.showAlert("Auto Tap Bot successfully purchased. Good job!");
                activateBot();
            } else if(hasBot && botExp <= Date.now()) activateBot();
            else if(hasBot) {
                let d = botExp - Date.now();
                tg.showAlert(`ü§ñ Auto Farm Bot is ACTIVE, ${Math.floor(d/3600000)}h ${Math.floor((d%3600000)/60000)}m remaining`);
            }
            updateUI();
        }

        function activateBot() {
            botExp = Date.now() + (12*60*60*1000); localStorage.setItem(v+'botExp', botExp);
            tg.showAlert("You have successfully reactivate your auto farming bot. Good job! üéâ");
            setTimeout(() => {
                fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST', headers: {'Content-Type':'application/json'},
                    body: JSON.stringify({chat_id: uid, text: "üóØü´Ü‚ö°Ô∏è Your auto tap bot has tapped coins for you. Come back to claim the coins and re-activate your bot."})
                });
            }, 12*60*60*1000);
        }

        function upgradeEnergy() {
            let cost = 2000 * (maxEng/1000);
            if(bal >= cost) { bal -= cost; maxEng += 500; updateUI(); tg.showAlert("‚ö° Energy Tank Expanded!"); }
        }

        function upgradeTap() {
            let cost = 2000 * tapLvl;
            if(bal >= cost) { bal -= cost; tapLvl++; updateUI(); tg.showAlert("üî® Tap Power Increased!"); }
        }

        function claimDaily() {
            const today = new Date().toISOString().split('T')[0];
            if(localStorage.getItem(v+'last') === today) return tg.showAlert("Come back tomorrow! üí§");
            streak = (localStorage.getItem(v+'last') === new Date(Date.now()-86400000).toISOString().split('T')[0]) ? streak+1 : 1;
            if(streak > 7) streak = 1;
            const rw = [0, 1000, 2000, 3000, 5000, 7500, 10000, 20000];
            const ms = ["", "Day 1: +1,000! ü™ô", "Day 2: +2,000! ‚ö°", "Day 3: +3,000! üî•", "Day 4: +5,000! üî®", "Day 5: +7,500! üöÄ", "Day 6: +10,000! ‚≠ê", "Day 7: +20,000! üèÜ"];
            bal += rw[streak]; localStorage.setItem(v+'last', today); localStorage.setItem(v+'streak', streak);
            tg.showAlert(ms[streak]); updateUI();
        }

        function activatePremium() {
            const input = document.getElementById('code-input').value.trim().toUpperCase();
            const p1 = (parseInt(suffix) + secretKey).toString(16).toUpperCase();
            const p2 = (parseInt(salt) * 157).toString(16).toUpperCase();
            if(input === `DVS-${p1}-${p2}-${suffix}`) {
                premExp = Date.now() + (3*24*60*60*1000); salt++; 
                localStorage.setItem(v+'premExp', premExp); localStorage.setItem(v+'salt', salt);
                tg.showAlert("Congratulations! You have successfully subscribed to Premium. You are now a Premium User!");
            }
        }

        function updateUI() {
            document.getElementById('balance').innerText = bal.toLocaleString();
            document.getElementById('diamonds').innerText = dia;
            document.getElementById('energy').innerText = eng;
            document.getElementById('max-energy').innerText = maxEng;
            document.getElementById('p-suffix').innerText = suffix;
            document.getElementById('eng-cost').innerText = (2000 * (maxEng/1000)).toLocaleString();
            document.getElementById('tap-cost').innerText = (2000 * tapLvl).toLocaleString();
            
            const btn = document.getElementById('bot-btn');
            if(!hasBot) btn.innerText = "PURCHASE FOR 15,000";
            else if(botExp > Date.now()) { btn.innerText = "WORKING..."; btn.className = "btn-gold btn-active-grey"; }
            else { btn.innerText = "ACTIVATE"; btn.style.background = "var(--green)"; }

            if(bal >= 50000) { bal -= 50000; dia++; confetti(); }
            localStorage.setItem(v+'bal', bal); localStorage.setItem(v+'dia', dia);
        }

        function tick() {
            if(eng < maxEng) eng++;
            const t = document.getElementById('prem-timer');
            if(premExp > Date.now()) {
                let d = Math.floor((premExp-Date.now())/86400000);
                let h = Math.floor(((premExp-Date.now())%86400000)/3600000);
                t.innerText = `PREMIUM: ${d}d ${h}h left`;
            } else t.innerText = "";
            updateUI();
        }

        function showTab(id, el) { 
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active'); el.classList.add('active');
        }

        async function uploadReceipt() {
            const f = document.getElementById('receipt-upload').files[0];
            const fd = new FormData(); fd.append('chat_id', chatId); fd.append('photo', f);
            fd.append('caption', `üßæ RECEIPT | Suffix: ${suffix}`);
            await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {method:'POST', body:fd});
            tg.showAlert("Sent! Verification pending.");
        }

        function showAd() { 
            const AdController = window.Adsgram.init({ blockId: "int-7434" });
            AdController.show().then(() => { bal += 3000; updateUI(); tg.showAlert("Ad Verified! +3000 Coins. Good job!"); });
        }

        function inviteFriends() { 
            const url = `https://t.me/share/url?url=https://t.me/Crypto_TapBot?start=${uid}&text=Join me on Crypto Tap!`;
            tg.openTelegramLink(url); 
            // Manual check logic would go here based on start parameter
        }

        let aTaps = 0; function handleAdminTap() { aTaps++; if(aTaps===3){ if(prompt("Pass:")==="DavisAdmin2026") document.getElementById('admin-box').style.display='block'; aTaps=0; } }
        function generateAdminCode() {
            const s = document.getElementById('adm-suffix').value; const sl = document.getElementById('adm-salt').value;
            const c = `DVS-${(parseInt(s)+777).toString(16).toUpperCase()}-${(parseInt(sl)*157).toString(16).toUpperCase()}-${s}`;
            document.getElementById('gen-result').innerText = c;
        }
    </script>
</body>
</html>
